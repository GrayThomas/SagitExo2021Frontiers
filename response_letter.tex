\documentclass[10pt,letterpaper]{letter}
\topmargin=-1in
\textheight=9in
\usepackage[latin1]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{booktabs}
\usepackage{xcolor}
\usepackage{graphicx}

\usepackage{amsmath}
\usepackage{amscd}  
\usepackage{bm,upgreek}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{wasysym}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{nccmath}
\usepackage{epsfig}
\usepackage{moreverb,url}
\usepackage{graphicx}
\usepackage{mathtools}
%\usepackage{bibtex}
%\usepackage{natbib}
\usepackage{zref-xr,zref-user,zref}
\zexternaldocument*{ms}
\usepackage[normalem]{ulem}


\def\label#1{\@bsphack
	\protected@write\@auxout{}%
	{\string\newlabel{#1}{{\@currentlabel}{\thepage}}}%
	\@esphack}

\newcommand*{\fakelabel}[3]{\@bsphack%
	\protected@write\@auxout{}
	{\string{\newlabel{#1}{{#2}{#3}}}}%
	\@esphack}

\renewcommand*{\ref}[1]{\zref{#1}}
\renewcommand*{\pageref}[1]{\zpageref{#1}}
\renewcommand*{\label}[1]{\zlabel{#1}}


\newcommand*{\ta}[1]{\textcolor[HTML]{107f10}{#1}}
\newcommand*{\tb}[1]{#1}
\newcommand*{\tc}[1]{#1}
\newcommand*{\td}[1]{#1}
\newcommand*{\te}[1]{#1}
\newcommand*{\tf}[1]{#1}

\newcommand*{\TODO}{\textcolor[HTML]{FF0000}{\bf TODO:}}


% Track removal
\newcommand*{\ra}[1]{}
\newcommand*{\rb}[1]{}
\newcommand*{\rc}[1]{}
\newcommand*{\rd}[1]{}
\newcommand*{\re}[1]{}
\newcommand*{\rf}[1]{}

%\renewcommand*{\cite}[1]{[#1]}
\newcommand{\example}[1]{

\rule{\textwidth}{1.5pt}
\begin{minipage}{.45\textwidth}%
\renewcommand*{\ra}[1]{\textcolor[HTML]{606060}{\sout{##1}}}%
\renewcommand*{\ta}[1]{}%
#1%
\end{minipage}\hspace{.099\textwidth}\begin{minipage}{.45\textwidth}#1\end{minipage}\\
\rule{\textwidth}{1.5pt}
}
\newcounter{reviewer}
\setcounter{reviewer}{0}
\newtheorem{rev}{Remark}[reviewer]


\newcommand*{\IEEEPARstart}[2]{\textsc{\textbf{#1}#2}}

\newcounter{section}
\newcounter{subsection}[section]
\newcounter{subsubsection}[subsection]
\setcounter{secnumdepth}{3}
\makeatletter

\newcommand\section{\@startsection {section}{1}{\z@}%
	{-3.5ex \@plus -1ex \@minus -.2ex}%
	{2.3ex \@plus.2ex}%
	{\normalfont\large\bfseries}}
\newcommand\subsection{\@startsection{subsection}{2}{\z@}%
	{-3.25ex\@plus -1ex \@minus -.2ex}%
	{1.5ex \@plus .2ex}%
	{\normalfont\large\bfseries}}
\newcommand\subsubsection{\@startsection{subsubsection}{2}{\z@}%
	{-3.25ex\@plus -1ex \@minus -.2ex}%
	{1.5ex \@plus .2ex}%
	{\normalfont\large\bfseries}}
\renewcommand \thesection{\@arabic\c@section}
\renewcommand\thesubsection{\thesection.\@arabic\c@subsection}

\hyphenation{Dis-ser-ta-tion}

\newcommand*{\hinf}{\mathcal H_\infty}

\newcommand{\reviewer}[1]{\begin{rev} #1\end{rev}}


\newcommand{\response}[1]{\par{\hfill\begin{minipage}{\dimexpr\textwidth-2cm} #1\end{minipage}}}

\address{Gray C. Thomas} 
%\signature{your signature} 

\newenvironment{thebibliography}[1]
{\list{\@biblabel{\@arabic\c@enumiv}}%
	{\settowidth\labelwidth{\@biblabel{#1}}%
		\leftmargin\labelwidth
		\advance\leftmargin\labelsep
		\usecounter{enumiv}%
		\let\p@enumiv\@empty
		\renewcommand\theenumiv{\@arabic\c@enumiv}}%
	\sloppy
	\clubpenalty4000
	\@clubpenalty \clubpenalty
	\widowpenalty4000%
	\sfcode`\.\@m}
{\def\@noitemerr
	{\@latex@warning{Empty `thebibliography' environment}}%
	\endlist}
\newcommand\newblock{\hskip .11em\@plus.33em\@minus.07em}

\newenvironment{head}
{parsetlength{leftskip}{1cm}setlength{rightskip}{1cm}noindentignorespaces}


\newcommand{\paperquote}[1]{%
	\begin{center}
		
		\begin{minipage}{.8\textwidth}
			{\rule{\textwidth}{.5pt}}\vspace{.5em}\\
			\begin{minipage}{\textwidth}\setlength{\parindent}{2em}#1\end{minipage}
			\vspace{.5em}
			{\rule{\textwidth}{.5pt}}
		\end{minipage}%
	\end{center}
}
\makeatother
\begin{document} 
	
	\begin{letter}{}
		
		\opening{Dear reviewers} 

		
\section{Common Concerns and Major Changes}
		
\subsection{The New Introduction}
\label{update:intro}
The introduction has been re-written to be shorter, clearer, and more coherently integrated.  Distracting background digressions on the autonomy of exoskeletons and the placement of amplification into existing conceptual frameworks have been discarded or marginalized.  

The opening paragraph now moves quickly through the various other forms of exoskeletons to reach a statement of what amplification exoskeletons are designed to do: magnify the physical strength of the operator. It focuses on an `interesting control problem' of  amplification---designing a pair of compliances for the human- and environment- side interfaces of the robot, a problem which is not central to the other exoskeleton applications.
\paperquote{
\IEEEPARstart{\ta A}{\ta{mplification}} \ta{of human strength is---among the many possible applications of exoskeletons---an especially interesting feedback control problem.}\ra{
	\IEEEPARstart{E}{xoskeletons} are a broad category of wearable robot\ra{ic}s with many potential applications.}
\ra{Some}\ta{This problem does not appear in exoskeletons that aim to either recover locomotion capability lost to disease \cite{KwaNoordenMisselCraigPrattNeuhaus2009ICRA,HaribHereidAgrawalGurrietFinetBoerisDuburocqMungaiMasselinAmesSreenathGrizzle2018CSM} or offload the strenuous work of rehabilitation therapy from therapists \cite{SugarHeEA2007TNSRE,KimDeshpande2017IJRR}.}
\ta{Nor is it significant in exoskeletons that aid healthy locomotion with timed power boosts \cite{MooneyRouseHerr2014JNRE,ZhangFiersWitteJacksonPoggenseeAtkesonCollins2017Science,LeeKimBakerLongKaravasMenardGalianaWalshJNR2018}.}
\ra{Exosuits (exoskeletons without rigid structures) have also seen some notable success in this area \cite{LeeKimBakerLongKaravasMenardGalianaWalshJNR2018}.}
\ra{This paper focuses on amplification control systems designed to magnify the physical strength of operators as they attempt non-repetitive, unpredictable tasks.}\ta{To amplify human strength is to treat forces of human origin differently from forces of any other origin.}
\ta{And we frame this problem as designing a pair of compliances (or integral-admittances\footnote{\ta{We prefer `compliance' to `integral-admittance' for brevity, but note that this makes `compliance' a transfer function of position per force.}}) for the human-side interface of the robot and the environment-side interface of the robot.
	%Amplification control systems are designed to magnify the physical strength of operators as they attempt non-repetitive, unpredictable tasks with unknown payloads.
	Amplification control systems are designed to magnify the physical strength of the operator as the operator interacts with an environment \emph{through the robot} while also reducing the weight and inertia the operator feels from the robot itself. This kind of control allows non-repetitive, unpredictable tasks with unknown payloads.
}}

Whereas the previous introduction had an unclear transition between the first paragraph and the second---a digression on the autonomy of exoskeletons---the new transition leads to gravity compensation control, which is a preliminary to our approach. This new paragraph on gravity compensation greatly shortens the previous explanation.

\paperquote{%
%%% Gravity compenstation is not amplification
\ta{Lifting \emph{fixed} payloads is a simpler problem. These loads can be lifted by directly compensating their nominal weight with actuator torque commands (the ``gravity compensation'' strategy).}
\ta{This compensation could be lifting mostly the exoskeleton itself \cite{KazerooniRacineHuangSteger2005ICRA}, or even offloading the operator's own bodyweight \cite{KongMoonJeonTomizuka2010TMech,LvZhuGregg2018CSM,LinLvGregg2019ACC}.}
\ra{\ta{Proper compensation} requires a decent model of the \ta{mass of the} exoskeleton \ta{and payload}\ra{mass}\ra{, h}\ta{.}}%
\ra{A \ra{backdrivable} system }\ta{In an exoskeleton system that can be easily backdriven by the operator, gravity compensation alone is a passable approach for\ra{ the}} \ra{capability platform application}\ta{lifting well-modeled payloads} \cite{Campbell2018Thesis}.
\ta{However, the operator must still accelerate the full inertia, compensate for any model error, and lift any extra payloads themselves.
	The inertia burden can be lessened by adding positive acceleration feedback \cite{Kazerooni2005IROS,KongTomizuka2009TMech}, but all three issues can be addressed by adding force-feedback-based amplification.}
}
This topic of force feedback now helps us transition to admittance control, which is the simplest way to incorporate force feedback. We do this with the context of the unsolved problems of gravity compensation fresh in our minds and see that admittance control only addresses a subset of these issues.
\paperquote{%
%% Admittance control is not ampilfication
\ta{Admittance control for exoskeletons \cite{YuRosen2013TCyb,FontanaVertechyMarcheschiSalsedoBergamasco2014RAM,JacobsenOlivier2014Patent,LecoursStongeGosselin2012ICRA} uses force sensor feedback at the human interface\footnote{\ta{Measuring human muscular effort, as can also be accomplished via electromyography (muscle measurement)} \cite{KawamotoSankai2005AR,YoungFerris2016TNSRE}.} in order to increase the human-side compliance, reduce sensitivity to the mass model, and lift unknown loads. But the compliance `increase' is relative to the admittance control plant: a position-controlled robot. Since position-controlled robots have very little compliance \cite{YuRosen2013TCyb,GonzalezAsada2019RAL}, the final human-side compliance of an admittance controller is not necessarily an improvement over the torque-controlled gravity compensation strategy. Additionally, the position-controlled plant of the admittance controller will attenuate all external forces acting on the robot. This attenuation typically deprives the operator of force feedback when they interact with the environment.}
}
Through this paragraph we introduce a less obvious deficiency with admittance control---the loss of force feedback to the user---and use this to transition into the extender concept, which solves this problem by using two force sensing interfaces:
\paperquote{
%% Amplification requires two force sensors
\ta{In order to allow bidirectional transmission of forces to coexist with amplification of human strength, the exoskeleton must transmit both amplified forces from the user to the environment and attenuated forces from the environment to the user.
	This suggests a force sensor configuration that can distinguish the environment from the user.
	Directly measuring the robot--environment interface and the robot--human interface with force sensors allowed \cite{KazerooniGuo1993JDSMC,KazerooniMahoney1991ICRA,KazerooniMahoney1991JDSMC} to control \emph{disparate} admittance behaviors for each interface.%
	\footnote{\ta{The HARDIMAN I exoskeleton \cite{MakinsonBodineFitck1969Techreport} attempted to do this as well, but with a flawed approach that neglected multi-joint coordination.}}
	But the controller from \cite{KazerooniGuo1993JDSMC} was still not designed to improve the human-side compliance relative to the torque-controlled gravity compensation strategy. It still used admittance control and a position-controlled robot.
	In this paper, we use force sensing at the human-robot and actuator-robot interfaces, and this serves the dual purposes of distinguishing the human from the environment and allowing torque control at the joints.
	The two interface compliances are then shaped with a cascade of amplification feedback on top of torque-controlled actuators.\footnote{More specifically, we use reaction force sensing series elastic actuators with torque control based on disturbance observers \cite{PaineOhSentis2014TMech,Paine2014Dissertation}.}}
}
The excerpt above points out that the solution offered by \cite{KazerooniGuo1993JDSMC} does not necessarily hide the inertia of the robot from the user (and therefore does not improve over the gravity compensation baseline in terms of human-side compliance). This sets up the next paragraph's discussion on the difficulty in certifying stability for systems that \emph{do} improve this compliance by reducing the apparent inertia.
\paperquote{
%% Problem of non-passivity
\ta{%
	Unfortunately, the problem of non-passivity is inherent to feedback control that conceals inertia. This is an issue regardless of how the inertia was concealed---through positive acceleration feedback \cite{Kazerooni2005IROS} or force feedback \cite{BuergerHogan2007TRO}.
	Without passivity, we must fall back to robust control in order to certify such behaviors. 
	Most importantly, the exoskeleton's human-facing port---its force--position relationship at the human--robot interface---will be in a feedback interconnection with the human's robot-facing port.
	Studies of this feedback interconnection \cite{Kazerooni1990TSMC,BuergerHogan2007TRO,BuergerHogan2006IROS,HeThomasPaineSentis2019ACC} and the human in particular \cite{HeHuangThomasSentis2019IROS} have modeled the human as a mass-spring-damper system with a range of parameter values. The most variable parameter is stiffness, as this depends on muscle contraction \cite{Hogan1984TAC}.
	We must demonstrate that no possible human behavior leads to instability---a robust control problem.
	Designing a machine to be passive \cite{ColgateHogan1988IJC,Hogan1989ICRA,ColgateBrown1994ICRA,AdamsHannaford1999TRA} can also be seen as a robust control problem: such designs guarantee stability against a very wide range of 'human' behaviors---the set of all passive transfer functions. Our prior work \cite{ThomasCoholichSentis2019AIM,HeThomasPaineSentis2019ACC,HeHuangThomasSentis2019IROS} has studied this stability problem for a table-mounted elbow exoskeleton.}
}
Thus, we have moved through the relevant literature in order of increasing complexity: gravity compensation to admittance control to extender control to robust control for non-passive human interfaces. Transitioning through mention of our previous work, we now enter the ``statement of contribution'' paragraph that also plays the role of signaling the non-standard paper layout.
\paperquote{
%%% STATEMENT OF CONTRIBUTION... Mention tasks so that they can be referred to in the structuring paragraph
\ta{In this paper, we scale up to a 12 degree of freedom (12-DOF) lower-body exoskeleton with 8 active and 4 passive joints. This includes a new multi-joint coordination approach modeled after humanoid robot controllers for torque-controlled joints \cite{SentisParkKhatib2010TRO,KimEA2016TRO} (e.g. the Valkyrie robot at NASA JSC \cite{RadfordEA2015JFR,PaineEA2015JFR}).}
\ra{present}\ta{More specifically, we contribute a comprehensive framework for achieving amplification control in exoskeletons that have torque-controlled joints and force sensing at the human interface. This contribution comprises (a) an optimization-based controller that determines robot joint torques using a prioritized list of `tasks' and a set of constraints that act on the sum of human and robot torques---the `Shared-Body Controller' (Sec.~\ref{sec:opt}); (b) a six degree of freedom (6-DOF) task that constrains the robot to follow human-led footstep transitions---the \ta{\emph{inter-foot force task}} (Sec.~\ref{sec:ift}); (c) a} frequency-domain amplification shaping control strategy that distills the complex approaches of \cite{HeThomasPaineSentis2019ACC} and \cite{ThomasCoholichSentis2019AIM} down to a single parameter tuning problem \ta{(Sec.~\ref{sec:fd}); (d) the construction of a generic amplification task that links the frequency domain control approach to the task-based framework (Sec.~\ref{sec:theory}); and (e) a demonstration of the control framework implemented in a lower-body exoskeleton (Sec.~\ref{sec:exp}).}\ra{ a comprehensive framework for achieving amplification control in exoskeletons that is based on force-sensor feedback and increases the compliance of the human interface\ra{. Our}\ta{; (b) a} frequency-domain amplification shaping control strategy \ta{which} distills the complex approaches of \cite{HeThomasPaineSentis2019ACC} and \cite{ThomasCoholichSentis2019AIM} down to a single parameter tuning problem (per amplified task)\ra{. The}\ta{;(c) a 6-DOF } framework includes foot contacts, inequality constraints, and computationally efficient prioritization of the tasks.} %% Roots of the controller come from Luis's work in WBC
}
Hopefully this new introduction makes our topic and point clearer, and contains fewer distracting concepts than our previous version. In editing it, we were able to remove a full column of text.


\subsection{The New Discussion}\label{update:discussion}
The discussion has been re-written to address Rmk.~\ref{rev7:proper_discussion}'s request for elaboration. It now addresses the applicability and the limitations of the method relative to the state of the art, open questions about the control framework (scalability, automated tuning), the benefits and drawbacks of the compliant actuators, and the control framework's potential applications.

% return to high level
\paperquote{
% return to high level
\ta{
	Strength amplification control offers us the potential to feel stronger as we manipulate the environment (including the loads) through our exoskeleton.
	This paper provides a framework that has put that vision into practice under laboratory circumstances, albeit with an exoskeleton that was not originally designed to manipulate the environment.
}
}

The following new subsection addresses the ``purpose'' question of Rmk.~\ref{rev2:purpose}---more concretely explaining what the framework can and cannot do. It also addresses Rmk.~\ref{rev7:disc_benefits_drawbacks} and Rmk.~\ref{rev7:proper_discussion}.A, discussing the limits, benefits, implications, and drawbacks of the approach taken.

\paperquote{
\subsection*{\ta{Benefits and Drawbacks}}
% What can it do (potential benefits) What kind of control performances are newly achieved How does this improve over the state of the art
\ta{
	This framework has several advantages relative to the state of the art.
	It respects contact limitations---guaranteeing that the exoskeleton will never force the person to roll their ankles, lift their toes, or slide their feet.
	It improves human-side compliance relative to the gravity compensation baseline without the anti-stable acceleration feedback of \cite{KazerooniRacineHuangSteger2005ICRA}.
	It keeps the human in control of the inter-foot force distribution using an elegant linear algebraic decomposition of the contact forces---a more general approach than Ref.~ \cite{JacobsenOlivier2014Patent}.
	It allows the operator to move heavy objects without removing the force-feedback path that they would need in order to move the objects carefully---a force-feedback path that is removed by admittance control strategies \cite{FontanaVertechyMarcheschiSalsedoBergamasco2014RAM}.
}
}


\paperquote{
% What can it not do (potential drawbacks)
\ta{
	Of course, the framework has downsides as well.
	The strategy depends on centralizing the contact between the human and the exoskeleton into a small set of sensors.\footnote{\ta{With one foot on the ground, our exoskeleton measures the human at two places: the hip/backpack attachment and the swing foot attachment.}}
	This centralization places a significant burden on the mechanical design and introduces a new failure mode---the ``force leak,'' where interaction between the robot and the operator occurs outside the sensors.
	Additionally, all amplified interaction with the environment must go through the exoskeleton structure---another mechanical design challenge.
	Due to the complexity of the mechanical design problem, the strategy makes it difficult to achieve the ultra-high energy density of successful locomotion augmentation exoskeletons \cite{KimWalshEA2019Science,MooneyRouseHerr2014JNRE}.
	This is an open problem.
	Augmentation exoskeletons are already close to the energy-density boundary at which the energy they provide is equal to the energy they cost the user due to their mass.
	The extra design constraints make it harder for amplification exoskeletons to cross this boundary even at slow walking speeds.
}
}

We elaborate more on Rmk.~\ref{rev7:proper_discussion}.A's request for implications and limitations through introducing some open problems/questions in the following subsection. The first paragraph addresses some elements of Rmk.~\ref{rev7:proper_discussion}.E's question about scalability beyond the current configuration of human--robot attachment points.

\paperquote{\label{paperquote:open_problems}
\subsection*{\ta{Open Problems in the Control Framework}}

% open questions in the control framework: 1: human approximation
\ta{The control framework itself also has some open questions.
	First, we approximated the mechanical impedance of the human and the cuff as being component-wise decoupled between the six degrees of freedom in our \emph{amplification task}.
	Since an extremely low amplification bandwidth is still stable, and since our tuning process increases bandwidth until instability is discovered, this approximation limits us by introducing conservatism in the final tuning. %
	Because of inter-component human coupling behavior, the tuning process may result in a different answer depending on the order with which the individual task sub-component bandwidths are tuned. %
}
}

The following paragraph addresses Rmk.~\ref{rev7:scalability}---addressing how the control framework could \emph{scale} beyond the current application. It also responds to Rmk.~\ref{rev7:proper_discussion}.E's question about more human--robot contact points.
\paperquote{
% second: scalability Address generality and scalability
\ta{Second, the framework was only tested with six \emph{amplification task} sub-components.
	In theory, it supports arbitrarily many task sub-components.
	And it is also theoretically possible to join the \emph{inter-foot force task} with the \emph{amplification task}---to make the swing foot capable of acting like an amplified manipulator.
	We lacked the sensing configuration for such a test: it would require the full 6-DOF interaction force/torque between the human foot and the exoskeleton foot to be measured, rather than just the vertical pressure between them.
	Thus, to validate the scalability our theory predicts, we would need an exoskeleton with either A) more sensorized human contacts (arms, for example) or B) the elimination of all human--environment contact that does not pass through the exoskeleton as an intermediary.
}
}

The following paragraph addresses Rmk.~\ref{rev7:parameter_adaptable} and Rmk.~\ref{rev7:proper_discussion}.B's requests to clarify the relationship between tasks and the tuning strategy, as well as Rmk.~\ref{rev7:proper_discussion}.C's question about the potential for automatic tuning.
\paperquote{
% 3rd: automoatic Controller tuning: is it task-dependent? Can controller tuning be automated?
\ta{Third, the controller tuning process is intended to be robust to all activities the operator performs, but we cannot know all these activities beforehand.
	A practical extension to this work would be to introduce an always-online learning process to continually adapt the tuning and avoid instability.
	Previously we have looked at tuning automation using online stiffness estimation \cite{HuangCappelThomasHeSentis2020ACC}.
	However, this type of automation could potentially be simpler: if the system starts to vibrate, it could reduce the amplification bandwidth until the vibration subsides.
	This is essentially how we tuned the system manually.}
}

\paperquote{
% automatic tuning, but higher performance.
\ta{On the other hand, higher performance might be obtained with a more complex strategy: modeling the human and redesigning the controller.
	Modeling the human online could draw on convex programs that automatically learn bounded-uncertainty models \cite{ThomasSentis2019TAC}. 
	With this more versatile system identification approach, even a human stiffness with `off-diagonal' terms could be learned.
	With every change to the model of the human stiffness bounds, robust control theory could synthesize a transfer matrix $\mathbf K(s)$ that guarantees stability.
}
}

The following paragraph addresses Rmk.~\ref{rev7:proper_discussion}.F's question about the extension of amplification control into domains without ground contact.
\paperquote{
% address Rmk.~\ref{rev7:proper_discussion}.F: no ground contact
\ta{Finally, the approach makes an assumption that a foot is always on the ground---and this precludes interesting applications in free-fall, underwater (with neutral buoyancy), or micro-gravity.
	In such circumstances, the \emph{amplification task} and \emph{inter-foot force task} structures would need to be combined together and significantly altered.
	A ``virtual single foot contact'' would not exist.
	In its place, the \emph{change in centroidal momentum} \cite{KoolenEA2016IJHR} would need to become the component of torque-space left intentionally unconstrained by the tasks.
	The remaining DOFs in torque-space would then be the subject of the new combined amplification task.
	The assignment of intuitive and easy-to-tune amplification controllers to such a task---which would concern an ever-changing subspace of the end-effector contact force space---is an open problem.
	However, the approach to parameterizing the \emph{internal forces of multi-contact} from \cite{SentisParkKhatib2010TRO} would be a reasonable starting point.
}
}

The following new subsection addresses Rmk.~\ref{rev7:proper_discussion}.D's request for a discussion on the potential limitations and drawbacks of series elastic actuators.
\paperquote{\subsection*{\ta{Series Elastic Actuators}}

%Benefits and drawbacks of the compliant actuators
\ta{Our exoskeleton hardware features series elastic actuators that are force/torque-controlled, and this decision also comes with benefits and drawbacks.
	To our knowledge, this paper is the first demonstration of Multi-DOF amplification control based on human interface force sensors and actuator force sensors (i.e. the series elastic elements).
	While such actuators are commonly used in wearable robots, they are a key part of our strategy, because with them we can avoid sensorizing the external force interface.
	This is a major advantage compared to systems designed to follow the extender concept \cite{KazerooniGuo1993JDSMC}.
	The lack of environment sensors gives us the freedom to properly handle amplification for environmental contract forces at any contact point along the structure of the exoskeleton (or at least in double support---we would need to amplify the \emph{inter-foot force task} to amplify contact between the environment and the swing leg).}

\ta{As for series compliance itself, however, control performance would be slightly better off with nearly-rigid springs.
	The series elastic actuators are simply torque sources to us, and direct drive motors offer higher bandwidth as torque sources.
	Removing the springs could also save weight.
	But series elasticity has some practical advantages: the force sensing is cheap and high quality, the robot's motors are protected from impacts, and both the transmission's friction and the rotor's reflected inertia are well hidden from the user.
}
}

The following new section also addresses the ``purpose'' question of Rmk.~\ref{rev2:purpose}.
\paperquote{
\subsection*{\ta{Potential Applications}}

% Clear purpose, not ``non-repetitive and unpredictable''
\ta{
	We have demonstrated the control framework on the Apptronik Sagittarius exoskeleton, which is designed to lift heavy body-distributed payloads as the user moves quickly.
	In this use case, the benefit of amplification control---relative to gravity compensation of the payload---is the potential reduction of inertial forces the user needs to compensate (without resorting to acceleration feedback) and the forces due to modeling error in the compensation.
	But this is not necessarily the most impactful application area for amplification as a technology.}
}


\paperquote{
\ta{To really see the potential of amplification, we would need to imagine an exoskeleton that was built for heavy-duty environmental manipulation.
	Such a system would need to move very slowly but with very high forces.
	If it were to move fast, it would require significantly more impressive power density than we typically see today.
	Such an exoskeleton, worn by a skilled operator, might be fielded in difficult terrain as an alternative to tracked construction vehicles, with specialized tools for manipulating the environment.
	These tools might be so massive that there exists no viable alternative for using them in unstructured environments.
	The exoskeleton would act as an adjustable bracing system that allows the operator to maneuver them into position.
	Perhaps the operator is a sculptor who uses the exoskeleton to lug a massive jackhammer up the mountainside in order to carve an ornamented staircase for tourists.
	Or maybe a forestry service worker is using it to operate a chainsaw at the end of a 24-foot telescoping pole.
	%% TODO: be very inventive here.
	Exoskeletons as platforms opens up the door to new industrial tools and potential job sites---all because they combine the maneuverability of people with the strength of machines.}
}

\paperquote{
% What problem is our control framework equipped to solve---out there industrial non-anthropomorphic tool holder.
\ta{Our exoskeleton is designed to mimic the kinematics of the person wearing it, but this is not the only way to go about the design. The control framework also has the potential to allow non-anthropomorphic legged robots to amplify human interaction. Imagine, for example, a robot connected to an operator's feet with long spindly legs that join together at a robot 'hip'. This hip also features an enormous power tool that requires the user to manipulate it with both hands. This architecture would require the same control system features as our anthropomorphic exoskeleton structure: strength amplification in the frame of the robot's hip, awareness of contact inequalities, and human-led footstep transitions.}
}







\subsection{Acknowledging the Limits of Linear Analysis}\label{update:linear_analysis_limits}

To address the problems summarized in Rmk.~\ref{rev1:linear_assumptions} and Rmk.~\ref{rev7:limitations_on_linearity}, we have made significant adjustments to Sec.~\ref{sec:theory} and Sec.~\ref{sec:fd} with regards to the necessary assumptions behind our use of frequency domain analysis and the spring-like human model (which, we note, is meant to represent a system that includes the compliance of the physical human--robot interface).

%% Re-definition of compliance that doesn't rely on small motion assumptions.
\subsection*{Avoiding Superposition in Definition of Amplification}
The first version of the paper included a definition of compliance that introduced small motion assumptions so that superposition of position signals could be used as in the linear systems case.
As pointed out in Rmk.~\ref{rev1:linear_assumptions}.A, Rmk.~\ref{rev7:limitations_on_linearity}.A, Rmk.~\ref{rev7:footnote_assumptions}, and Rmk.~\ref{rev7:assumptions_not_easy}, these small motion assumptions are unrealistic and weaken the results of the paper.
Fortunately, these small motion assumptions are not necessary.
We can define compliance, and talk about compliance ratios, without them.
This definition (recall that it is in the context of the ideal amplification control law) is shown in the following excerpt from Sec.~\ref{sec:theory}, directly after Def.~\ref{def:ideal_amp}.

\paperquote{
This control gives the human a clear advantage, with respect to \ta{both} environmental forces and the dynamics of the exoskeleton as perceived by the operator.

\ta{We can also express this advantage using a ratio of compliances.
	More specifically, we consider instantaneous compliances---transfer functions relating infinitesimal force to infinitesimal motion of the closed-loop robot.
	These instantaneous transfer functions change over time due to the non-constant mass matrix.
	But at any instant in time, the instantaneous compliance of the robot with respect to the human is \emph{exactly} $\alpha$ times its compliance with respect to the external force---because this simply restates the relationship between the coefficients on $f_c$ and $f_e$ in \eqref{eq:ideal_amplification}.
	Therefore, we can} define amplification as the ratio of compliance transfer functions between the larger human-side compliance and the smaller environment-side compliance. }


%% Treatment of nonlinearity
\subsection*{Treatment of Non-linearity}

To address the usefulness of our analysis and assumptions (Rmk.~\ref{rev1:linear_assumptions}.C), as well as explain our handling of non-linearity (Rmk.~\ref{rev1:linear_assumptions}.B), we have added a paragraph in Sec.~\ref{sec:fd}.

\paperquote{
% linearity assumptions
\ta{Using force feedback control, we can achieve amplification that is a linear transfer function---despite the fact that both the human-side compliance and environment-side compliance are nonlinear, their ratio can be linear. However, to address stability questions in the frequency domain we must make conservative simplifications for both the human and the human-side compliance. In particular, we will make a useful simplification that the exoskeleton has some constant linear compliance that is dominated by inertial effects. Similarly, we will assume that the human has a constant linear compliance. These assumptions are useful in that they capture the primary failure mode of amplification systems: an oscillation between a mass-like exoskeleton and a spring-like human that gains energy due to the force feedback. But the assumptions, of course, fail to describe many other behaviors.}
}

To further clarify the usefulness of our assumptions (addressing Rmk.~\ref{rev1:linear_assumptions}.C), we have added a paragraph about the decomposition assumption.
\paperquote{	
% decomposition assumptions
\ta{In addition to assuming linearity, we will further simplify by assuming that we can neglect the coupling between the three components of torque and the three components of force that exist between the human and the exoskeleton. This is useful in that it simplifies the stability analysis and avoids some very complex data-driven modeling problems. But it introduces some caveats, which we will discuss in Sec.~\ref{subs:open_control}.}
}

The referenced caveats are excerpted in Sec.~\ref{update:discussion}, on page \pageref{paperquote:open_problems} of this letter.
%% Definition of Human which includes the interface compliance
\subsection*{Inclusion of Interface Compliance in Human}

To address questions about the human interface compliance (Rmk.~\ref{rev7:limitations_on_linearity}.B, Rmk.~\ref{rev7:limitations_on_linearity}.C, and Rmk.~\ref{rev7:physical_interface_compliance}) and the human system more generally (Rmk.~\ref{rev7:human_side_env_side}, Rmk.~\ref{rev7:human_as_spring}), we have added a new paragraph explaining how this compliance is treated as part of the human model. This paragraph also addresses Rmk.~\ref{rev7:human_side_env_side}'s question about what constitutes the human-side and Rmk.~\ref{rev1:linear_assumptions}.E's question about the human's behavior during motion.


\paperquote{
% complex human stiffness
\ra{Since the human}\ta{The robot's human-side interface is coupled to a system: a human wearing a physical cuff attachment. This system has many sources of flexibility: the physical cuff interface, the human's soft tissue, and the human's neuromuscular control---all of which are complicated and nonlinear. We model this whole system as an uncertain spring that pulls the physical cuff interface towards the human's desired equilibrium. This desired equilibrium can change when the human intends to move dynamically, but the transfer function is with respect to this equilibrium point, so it is still valid.}
\ta{This spring is ``the human'' for the purposes of controller design.}	
}


	
To partially address Rmk.~\ref{rev1:linear_assumptions}.D's request to back up our model, we've clarified why we used it. Unfortunately, explicit system identification of the human wasn't part of our project's scope---we used a gain tuning procedure in place of system identification, and this is fundamentally less informative. 
.
\paperquote{
%% Motivating the Human Model
\ta{As demonstrated in the human elbow joint \cite{HeHuangThomasSentis2019IROS}, the complex stiffness model is not just a mathematically convenient model, but also a more accurate description of real human-in-exoskeleton behavior than the linear spring-damper.}
\ra{The complex stiffness model introduced in \cite{HeHuangThomasSentis2019IROS} offers a more accurate model where the human dissipates energy.}%
\ta{The} complex stiffness model \ra{treats the human}\ta{results in a human compliance transfer function with a constant magnitude and a constant phase-lag.} \ra{as a spring with a constant\ta, frequency-domain phase lag}\ta{And this phase lag represents}\ra{ to represent} the non-linear damping properties of the human. The model is explicitly only a frequency domain model, but the behavior is similar to what might be achieved with \ta{hysteresis or} coulomb friction\ra{ that scales with the spring force magnitude.}\ta{.} \ra{We do not model the inertial behavior of the human.} 
}






\subsection{Unclear Experimental Results Figure}\label{update:experiment_figure}

The figure describing the experimental results, Fig.~\ref{fig:experiment} in this new version of the paper and Fig.~7 previously, has been edited for clarity (as requested in Rmk.~\ref{rev1:figures}). Boundary-crossing arrows have been removed, addressing Rmk.~\ref{rev7:arrows_crossing_fig_boundaries}, and the confusing second line (which had previously depicted an internal control system variable) has been removed from the top twelve subplots (and from the video attachment), leaving only the measured human effort. 
Extraneous angles and torques for non-sagittal plane joints have also been removed, addressing Rmk.~\ref{rev7:pare_down_angles}.
Sign conventions for the sagittal plane joints are now included in the legend, addressing Rmk.~\ref{rev7:signs_of_joint_angles}. As requested in Rmk.~\ref{rev7:rad_to_deg}, the angles are now in degrees rather than radians. 

\resizebox*{\textwidth}{!}{\centering%
\input{rl_experiment_v2.pdf_tex}%
}

The caption below has been written to address Rmk.~\ref{rev1:figures} and Rmk.~\ref{rev7:exp_fig_caption_story}. This caption now also explains the dip at 10 seconds in D.5, addressing Rmk.~\ref{rev7:whats_up_with_squat}. It also explains how the robot's joint angles and torques are measured, addressing Rmk.~\ref{rev7:torques_and_angle_sensors}.

\paperquote{\footnotesize
{\ta{The four experiments from Tab.~\ref{tab:expparam}, shown as subfigure columns A--D, are compared in terms of the three sagittal plane components of the human--robot interaction force/torque, the sagittal joint torques, and the sagittal joint angles. In Exp.~\ref{subs:amp}.1 (A), the exoskeleton joints apply no torque (as shown in A.4), and the human--robot interface supports $\approx300$ N (as shown in A.3) as well as a $\approx35$ Nm moment at the hip (as shown in A.1). In Exp.~\ref{subs:amp}.2 (B), the controller is turned on with $\alpha_0=1$ (no amplification), and human--robot vertical force (B.3) and sagittal torque (B.1) are vastly decreased due to gravity compensation. In Exp.~\ref{subs:amp}.3 (C), a 11~kg mass is attached to the back of the exoskeleton (as shown in Fig.~\ref{fig:experimental_condition}), and this produces an increase in the human--robot sagittal torque (C.1), $\approx30$ Nm. Finally, Exp.~\ref{subs:amp}.4 (D) increases $\alpha_0$ from 1 (no amplification) to 3 in the sagittal tasks, and the human--robot sagittal torque increase due to the added mass is reduced by roughly a third---considering B.1, C.1, and D.1 representing the average numerical value of the curves, D.1 $-$ B.1 $\approx 1/3($C.1 $-$ B.1$)$---as expected. With the amplification engaged, the operator deepens the squat at 10 seconds (D.5) and then moves to a second, less extreme squat at 20 seconds (D.5), showing that the torque reduction continues to work. This squat is shown in the video attachment  \cite{Thomas2020Youtube}. We would also expect that amplification would reduce the vertical force from the added mass; however, the vertical force remains roughly zero before adding the weight (B.3), after adding the weight (C.3), and with both the weight and amplification (D.3)---the expected 110 N force increase between (B.3) and (C.3) did not occur. Since the operator recalls feeling vertical forces from the addition of the mass, we suspect that there is a ``force leak'' where the vertical component transferred to the operator in a way the force sensor could not detect. Torque and angle measurements in the bottom two subfigure rows are measured using the robot's spring deflection encoders and joint encoders, and therefore represent the robot's---and not the operator's---torque and position.}
		}
}

\subsection{Quantitative Comparisons to Literature}\label{update:quantitative_comparisons}

To address Rmk.~\ref{rev1:performance_comparisons} and Rmk.~\ref{rev1:quantitative}, we've expanded our quantitative comparisons with the literature. The following paragraph, excerpted from Sec.~\ref{subs:amp_disc}, highlights: Rmk.~\ref{rev1:performance_comparisons}.A) the useful novelty of the method (using the backpack/hip sensor to perform amplification); Rmk.~\ref{rev1:performance_comparisons}.B) the achieved control performance; and Rmk.~\ref{rev1:performance_comparisons}.C) comparisons to other controllers that amplify human strength in systems with different hardware configurations.

\paperquote{
\ta{
	Our system is pioneering in that it amplifies human strength at the backpack/hip link of the exoskeleton; there are no direct performance comparisons for this control feature.
	Our steady state amplification of human forces by 300\% exceeded the 208\% amplification (52\% mass reduction) of sagittal hip moment in \cite{ZanottoAkiyamaStegallAgrawal2015TRO}, which also used force feedback to amplify human lower-body strength.
	However, this is not an exact comparison, as \cite{ZanottoAkiyamaStegallAgrawal2015TRO}'s system used a treadmill mounted exoskeleton, had a different sensing configuration, and has only two degrees of freedom whereas our system has 12.
	The amplification's pole frequency (.58 Hz) and amplification magnitude ($\alpha_0=3$) at the hip/backpack human--robot interface are comparable to our previous results on a 1-DOF human elbow exoskeleton; in the notation of Appendix A, \cite{HeThomasPaineSentis2019ACC}'s robust controller used $\alpha_0=10,\ k_G=0.1,\ Z_g=10,\ \text{and}\ P_g=0.01,$ resulting in an amplification magnitude of 2.995 at 0.58 Hz.
	However, unlike our controller, \cite{HeThomasPaineSentis2019ACC} had even greater amplification at lower frequencies: its lowest pole-pair was at $0.146$ Hz, and its steady state amplification rate was 9.91.
	%In terms of \emph{mechanical} performance, our preliminary testing suggests a payload capacity of $\sim$11-23 kg, which is lower than \cite{Kazerooni2005IROS}'s 34 kg.
}
}


\subsection{Dark Rviz Figure}\label{update:rviz_figure}
As mentioned in Rmk.~\ref{rev7:rviz_figure} and Rmk.~\ref{rev1:figures}, the figure explaining the Rviz graphics that appear in the video was low-contrast and extremely hard to see. Using image manipulation software, I was able to improve the color-clarity and contrast of this sequence of images and the corresponding frames of the video attachment. Hopefully this makes it legible on all of your computers.
%Unfortunately, I was not able to make the background white without obscuring the detail (there is a tradeoff between color intensity and contrast and the amplification of ugly color artifacts which obscure the edges of the visualization). (I also, in hindsight, wish that I'd spent more time trying to change the rviz default behavior, which is the source of this dark background with bright lines.)
%The scenes of the rviz visualization in the video (which this figure serves to explain) are not so easily adjustable. Overall, however, the figure has much better contrast than before:
 
\includegraphics[width=.499\textwidth]{figs/screenshot_A.png}\includegraphics[width=.499\textwidth]{figs/screenshot_B.png}

And in grayscale the contrast is also improved.

\includegraphics[width=.499\textwidth]{figs/screenshot_A_gray.png}\includegraphics[width=.499\textwidth]{figs/screenshot_B_gray.png}

This color adjustment should let the print readers at least see the movement of the GRF vector from one foot to the other.


		

\subsection{Writing Quality}\label{update:coherency_flow}

To address Rmk.~\ref{rev1:organization_context} and Rmk.~\ref{rev7:general_presenatation}, requesting improvements to the structure of the presentation, we have---in addition to explicitly describing the relationship between paper sections using a paragraph in the introduction (see Sec.~\ref{update:intro})---revisited the sentences that are used to transition between structural elements of the paper.

\example{
\ra{In this section we introduce an ideal strength amplification behavior as a task for a redundant robot. This represents the ideal behavior in the sense that it is an unimplementable control law that requires unlimited control bandwidth. It serves to demonstrate some properties of the amplification behavior.}%
\ta{Strength amplification can be illustrated using the example of an ideal fixed-base (arm-like) ``exoskeleton'' performing a force-feedback behavior with its human and environment contacting link (that is, its end-effector).}
}

\paperquote{
\ta{Since ideal amplification cannot be attained, we will need to consider the design space of realistic amplification behaviors. Frequency domain linear control theory offers the tools necessary to consider the stability and passivity of the various behaviors we could achieve via dynamically compensated force feedback.}
}

\paperquote{
% what are complianes, and what does this subsection cover
\ta{We will consider the way force feedback influences the mechanical impedance of the human--robot and human--environment ports. More specifically, we will study the compliance (integral admittance) of the exoskeleton at these two ports. This variant notation (compliance instead of impedance) is helpful for considering the stability of a feedback interconnection with a spring.}
}

\paperquote{
Human-led \ta{foot} contact transitions\ta{, such as walking or shifting balance,} are an important part of any scheme for controlling \ra{multi-contact}\ta{lower-body} exoskeletons, \ta{and they do not naturally emerge from the \ta{\emph{amplification task}} as one might hope.} To allow this critical feature we introduce a \ta{second task, the \ta{\emph{inter-foot force task}}, that is achieved simultaneously and } causes the exoskeleton to follow \ta{human-initiated foot lifting}.
}

\paperquote{
\ta{To combine the \emph{amplification task} and \emph{inter-foot force task} while also respecting limitations on the exoskeleton, we compute the joint torques of the exoskeleton using a linear optimization problem. This problem uses concepts of contact constraints, prioritization between task sub-components, a weighted 1-norm cost, and the actuator-mapped reaction force space in order to be computationally efficient.}
}

\paperquote{
% passive joints and predictability
\ta{At this point, we can express the optimization problem that the shared-body controller needs to solve at every controller update.}
\ta{Note that the passive joints\footnote{\ta{The exoskeleton has 2 passive DOFs per leg: ankle inversion/eversion (ankle roll) and internal/external rotation of the hip (hip yaw).}} are treated as being active joints for the purpose of the optimization. Their non-zero torques represent the expectation of the exoskeleton on the human operator.}
}

\example{
\ra{To better understand the behavior of this complex control strategy, we turn to the behavior of a physical realization in a lower-body exoskeleton.}\ta{Implementing the control framework into a physical lower-body exoskeleton allows us to demonstrate both amplification and footstep transitions.}
}

\paperquote{
%% Setting priorities
\ra{One might suspect that the order of task importance would be easy to determine a priori, but it was a rather empirical weighting process in practice.}%
\ta{We iterated various priority rankings between the components of the \emph{amplification task} until our operator was satisfied with the behavior.}
\ra{First, seeking to fall back to the linear inverted pendulum behaviors of a point foot robot (that is, prioritizing amplification in the direction between the center of mass and the center of pressure as well as amplification in hip pitch---similar to the hip tasks of the Hume biped \cite{KimEA2016TRO}) we found them to frustrate the operator with their naturally unstable lateral position.}%
\ta{First, we attempted to re-create linear inverted pendulum behavior by prioritizing the moment components over the force components. This prioritization had been effective with the Hume biped robot \cite{KimEA2016TRO}. Unfortunately, this first approach frustrated the operator, as the exoskeleton was naturally unstable.}
\ta{We eventually settled on the weightings in Tab.~\ref{tab:priorities}, which sacrifice $x$-torque first and are more comfortable for the operator.}
}

\paperquote{
\ra{With or without amplification, the primary behavior of the system was to use shared-body control to partially compensate the robot's own gravity while allowing human-led foot transitions through the \ta{\emph{inter-foot force task}}.}\ta{Distributing weight between the two feet using the \ta{\emph{inter-foot force task}} is a key behavior of the system and was tested when the operator walked on level ground and stairs.}
Since the robot itself was based on high bandwidth torque-controlled actuation, the operator could easily backdrive it to climb up stairs or to stand on one foot.%
\ra{Since this was the case\ta{,} gravity compensation was the dominant effect of the controller, with amplification acting in a supplemental role.
	But \ta{with or without amplification}, the control of the contact transitions via the \ta{\emph{inter-foot force task}} was key.}
\ta{While this happened, the exoskeleton continued to compensate for its own gravitational weight and amplify strength at the hip/backpack sensor.}
}

\example{
\ra{In our own prior work in exoskeleton control, we}\ta{The control strategy we previously published in \cite{HeThomasPaineSentis2019ACC} can also be re-expressed in terms of an amplification transfer function. Ref.~\cite{HeThomasPaineSentis2019ACC}} explored [\textellipsis]
}

	
		
		
		
		
		
		
		
		
		
		
%%%%%%%%%%%%%%%%%%%%%		
		
		
		
\section{Specific Concerns}

		%%
\subsection{Reviewer \#1}
\setcounter{reviewer}{1}
\setcounter{rev}{0}
{\it
This paper proposes an assistive control framework for an exoskeleton robot. In this framework, a control method to amplify strength of a
user in task space was considered. Transfer function analysis was
conducted for a linear dynamics model. Authors explored computationally
feasible way of deriving control outputs with multiple constraints by
using weighted scalarization costs. Using weighted 1-norm cost on the
vector of all task errors was proposed. In addition, authors propose to
use a steady state equilibrium to approximately represent the
relationship between the torque input and the force for faster
optimization calculation. Real exoskeleton robot experiments were
conducted.}
\reviewer{\label{rev1:performance_comparisons}
Although the proposed method would be potentially an interesting
approach to control exoskeleton robot, [Rmk.~\ref{rev1:performance_comparisons}.A] currently the results presented
in this paper dose not clearly show the usefulness of the method. [Rmk.~\ref{rev1:performance_comparisons}.B] What
kinds of control performances dose the proposed method newly achieved?
[Rmk.~\ref{rev1:performance_comparisons}.C] Comparison between the proposed method and existing approaches would be
necessary.}
\response{This is addressed in Sec.~\ref{update:quantitative_comparisons}. Useful applications are also addressed in the discussion (see Sec.~\ref{update:discussion}).}

\reviewer{\label{rev1:organization_context} Furthermore, organization of the paper needs to be improved.
	Relationships between the contents described in each section are not
	very clear.}

\response{As mentioned in Rmk.~\ref{rev7:intro_signpost}, the non-standard layout of the paper's sections requires mention in the introduction, which is now part of the final paragraph in the new introduction (Sec.~\ref{update:intro}). More general flow improvements are addressed in Sec.~\ref{update:coherency_flow}.}

			
\reviewer{\label{rev1:explicit_constraints}Equality constraints X need to be explicitly defined for the cases
described in Section VI, Implementation in hardware.}
\response{The equations have been clarified where space permits. More detail is available in the github repository \cite{Thomas2019LPExo}. The foot contact constraint behavior has been elaborated:}
\paperquote{
\ra{That is to say, so long as the feet do not slip or pull up on the ground.}\ta{The inequalities described by $C_r$ and $c_r$ are simple approximations of the friction cone: for example, two rows would be used to express $\mu |f_x|\leq f_z$, where $\mu$ is the friction coefficient.}
}
\response{And the reference frames have been elaborated:}
\paperquote{
\ta{We introduce two new reference frames: frame $s$ (for ``sum''), and frame $d$ (for ``difference'').}
\ta{Both frames are weighted averages of the two foot frames.}
\ta{Frame $s$ is approximately matched with the human center of pressure.}
\ta{Frame $d$ is the mirror image of frame $s$, and both frames overlap at the mid-foot point when the human puts equal weight on each foot.}
\ta{Transformation $\prescript{s}{}{X}_1^*$ converts spatial force vectors from the 1$^{\rm{st}}$ foot's frame to frame $s$, and $\prescript{s}{}{X}_2^*$ is the same for the other foot.}
}
			
\reviewer{\label{rev1:linear_assumptions}In general, [Rmk.~\ref{rev1:linear_assumptions}.A] transfer function analysis (presented in Section III) is
valid only for linear systems. However, [Rmk.~\ref{rev1:linear_assumptions}.B] the target exoskeleton robot
system has highly nonlinear dynamics. Therefore, [Rmk.~\ref{rev1:linear_assumptions}.C] usefulness of these
analyses is unclear. Authors need to [Rmk.~\ref{rev1:linear_assumptions}.D] quantitatively show how the
behavior of the exoskeleton robot system has similar properties to the
analyzed model in Section III with using experimental data. [Rmk.~\ref{rev1:linear_assumptions}.E] How can
these transfer function analyses be useful when a human user moves
dynamically? }
\response{ This is addressed in Sec.~\ref{update:linear_analysis_limits}.}
			
\reviewer{\label{rev1:figures}It is difficult to understand what authors want to claim in Figs 7 {\normalfont[now Fig.~\ref{fig:experiment}]}
and 9 {\normalfont[now Fig.~\ref{fig:transitions}]}. These figures and captions need to be improved.}
\response{This is addressed in Sec.~\ref{update:experiment_figure} and Sec.~\ref{update:rviz_figure}.}
			
\reviewer{\label{rev1:quantitative}Quantitative results are necessary for the real robot experiments.
Comparisons with other methods are also required.}
		
\response{This is addressed in Sec.~\ref{update:quantitative_comparisons}.}

		%%%%%%%%%%%%%%%%%%%%%%%%%
		%%%%%%%%%%%%%%%%%%%%%%%%%
	\subsection{Reviewer \#2}
\setcounter{reviewer}{2}
\setcounter{rev}{0}

{\it In order to develop a controller algorithm for general purpose human
power augmentation system using exoskeleton, the authors propose
impedance based controller using bode diagram shaping of the impedance
characteristics and task decomposition control. The core idea is to
control the interface impedance with higher compliance on the user side
and lower compliance on the environment side. I can see that huge
amount of effort has been done to implement the controller system.
However I would like to recommend revision of the manuscript.}
			
\reviewer{\label{rev2:purpose}The purpose of the system is not clearly stated. What I found in the
introduction is that the proposed system deals with tasks that are
"non-repetitive and unpreditable", therefore it reads that the authors
are trying to develop a general purpose human power augmentation system
that is able to do supposedly anything. Therefore, it is not possible
to evaluate if the proposed controller is suitable for the purpose. For
this reason I would recommend revision of the paper to include clear
definition of the purpose of the system with what the system is aimed
to do, and discussion about what it can do and what it cannot do.
} 
\response{The limitations on the applicability of our approach are now addressed in both the introduction (see Sec.~\ref{update:intro}) and the discussion (see Sec.~\ref{update:discussion}).}
		
		
		%%
\subsection{Reviewer \#7}
\setcounter{reviewer}{7}
\setcounter{rev}{0}	
{\it The authors present a comprehensive framework for strength
amplification control in exoskeletons based on force signals measured
at the human-robot interaction points. To alter the amplification as
desired, the authors propose to change the compliance of the human
interface, taking into account relevant constraints and task
prioritisation method.}

\reviewer{\label{rev7:general_presenatation}In general, the presentation needs to be significantly improved as it
is hard to follow the paper and understand it in its current form -
this concerns both the text and the figures.}
\response{Clarity has been improved in the introduction (see Sec.~\ref{update:intro}) and discussion (see Sec.~\ref{update:discussion}), as well as more generally (see Sec.~\ref{update:coherency_flow}). The figures have been improved as per your later comments. Two figures were common concerns addressed in Sec.~\ref{update:experiment_figure} and Sec.~\ref{update:rviz_figure}).}

\reviewer{\label{rev7:assumptions_not_easy}The developed framework
seems to be relying on assumptions that are not easy to meet in the
real-case scenarios,}
\response{This was a common concern (see Sec.~\ref{update:linear_analysis_limits}).}

\reviewer{\label{rev7:disc_benefits_drawbacks}and a discussion with clear benefits and drawbacks
of using the proposed framework,}
\response{The various improvements to the discussion are addressed in Sec.~\ref{update:discussion}.}

\reviewer{\label{rev7:scalability}and its scalability beyond the
presented scenario is missing.}
\response{Scalability is now addressed in the new discussion (see Sec.~\ref{update:discussion}).}
			
\reviewer{\label{rev7:introduction_in_general}The introduction is too long and hard to follow. The main
contributions of the paper are scattered across the entire section or
are completely missing from this section only to be found on e.g., page
12 (see the attachment for details). I am not sure that all
categorisations such as e.g., human-in/on/is-the-loop, and even more,
the details the authors are going into concerning these distinctions,
are necessary (in this section/paper). I would suggest that authors
focus on the main contributions of their work in this section, and only
analyse - clearly and concisely - what has been done in the literature
in relation to their contribution.}
\response{The Introduction section has been re-written, and the changes are explained in detail in Sec.~\ref{update:intro}. These changes include shortening the introduction, improving the flow between paragraphs, stating the contributions more clearly, and removing the unnecessary categorizations. }
			
\reviewer{\label{rev7:coherency_and_flow}Throughout the entire paper, a lot of explanations/information is
either missing or is to be found later in the text. Similarly, in some
cases, there is no clear flow between subsequent paragraphs, which
makes it hard to follow. For example (details to be found in the
attachment), the authors mention two tasks, then a few paragraphs later
talk of multiple tasks, only to mention later in the text there is a
total of 12 tasks. Information scattered in such a way is very
confusing to the reader.}
\response{Flow between paragraphs and information order is addressed in Sec.~\ref{update:coherency_flow} and has been also been improved thanks to your remarks below. Unclear wording on tasks has been changed to mention only two true `tasks': the \emph{inter-foot force task} and the \emph{amplification task}. There are 12 `task sub-components'.} 

			
\reviewer{\label{ref7:figures_in_general}Figures are hard to read and not always easy to understand. On the
one side, this is the consequence of too many sub-figures being
squeezed into too small space and not well aligned. On the other side,
the figures in the later sections of the paper are missing any relevant
caption (apart from the title), which makes the reader look for a
description of the figure meaning in the text.}
\response{The two biggest changes are addressed in Sec.~\ref{update:experiment_figure} and Sec.~\ref{update:rviz_figure}. Many other comments you made on figures and captions are individually addressed below.}
			
\reviewer{\label{rev7:limitations_on_linearity}The definition of amplification as the ratio of compliance transfer
functions relies on [Rmk.~\ref{rev7:limitations_on_linearity}.A] the assumption of linear DE (small motion
magnitude, near-zero velocity, non-singularities zone), which is hardly
met in practice. Furthermore, [Rmk.~\ref{rev7:limitations_on_linearity}.B] the analysis of the stability of the
human-robot pair is based on the assumption of the rigid human-robot
connection (physical interface), which is never the case in practice.
[Rmk.~\ref{rev7:limitations_on_linearity}.C] No proper analysis of the effects of physical interfaces has been
presented in the paper.}
\response{This is addressed in Sec.~\ref{update:linear_analysis_limits}.}
			
\reviewer{\label{rev7:proper_discussion}A proper Discussion section is missing, [Rmk.~\ref{rev7:proper_discussion}.A] where limitations and the
implications of the proposed control framework are discussed in
elaborate way. For example, [Rmk.~\ref{rev7:proper_discussion}.B] it is not clear if the controller tuning
parameter is also task-dependent (in addition to DoF-dependent), and if [Rmk.~\ref{rev7:proper_discussion}.C]
it would be possible to automate the tuning. [Rmk.~\ref{rev7:proper_discussion}.D] A discussion on the
potential benefits or drawbacks of using physical compliance (in the
actuator) would also be interesting, as such devices are inherently
force sensors, have large bandwidth, and adjustable compliance - all
desirable features of the proposed framework. Further,  [Rmk.~\ref{rev7:proper_discussion}.E] how would this
transfer to devices with multiple human-robot attachment points (as
opposed to effectively an end-effector device in this work),  [Rmk.~\ref{rev7:proper_discussion}.F] and to
devices that require strength amplification but have no ground contact
(to compensate for gravity)?}
\response{The discussion has been re-written (see Sec.~\ref{update:discussion}).}
			
\reviewer{\label{rev7:proofread}I highly suggest the paper be proof-read as there are multiple typos
and incorrect grammatical constructions throughout the paper.}
\response{We have carefully proofread the document.}


\subsubsection*{On Sec.~\ref{sec:intro}, Introduction}

\reviewer{\label{rev7:intro_length} of 1.5 page is by all means too long, and it is not easy to follow. some paragraphs are also too long, and the way the work of others is presented is sometimes confusing.}
\response{The entire introduction has been reviewed, and most of the language has been replaced. It is now 1 page (see Sec.~\ref{update:intro}).}
		
		
\reviewer{\label{rev7:highlight_contribution_earlier}
I like the idea that the main contribution of the paper is already given in the first paragraph, after short intro. but this, followed by 1.5 page to go through the literature makes it confusing what is actually the contribution of this paper.}
\response{There are fewer digressions from the contribution of the paper in the updated introduction (Sec.~\ref{update:intro}).}

			
\reviewer{\label{rev7:intro_structure_suggestion}I suggest to clearly outline the contribution, and then give a short overview of the state of the art in terms of the main aspects of your contribution. there is no need to elaborate on so many different works in such a detail.}
		
\response{This is addressed in Sec.~\ref{update:intro}.}
		
\reviewer{a clearer distinction should be made here between `capability platform' and `manual material handling'}
		
\response{This distinction has been removed (Sec.~\ref{update:intro}).}
		
\reviewer{what does it mean ``human-si-the-loop''. please elaborate more}
%	
\response{This digression has been removed (Sec.~\ref{update:intro}).}
		
\reviewer{``But even within exoskeleton control, amplification is very low-level.'' ---
this comes unexpected. what is exactly meant by this?
			
do you want to say that amplification is ``human-is-the-loop''? if so, this needs to be made clear
			
further, does ``human-is-the-loop'' mean that robot is fully external to the human, which is a system merely attained by a robot?}
%
\response{This digression has also been removed (Sec.~\ref{update:intro}).}
		
\reviewer{this is now mentioned as an example of the ``human-is-the-loop'', but it is not clear to me how BLEEX is different from the ``capability platform''}
%		
\response{The ``human-is-the-loop'' idea has been removed (Sec.~\ref{update:intro}). BLEEX is a capability platform, but the capability platform idea is also no longer a framework we use in the introduction. BLEEX is no longer mentioned by name but is cited as lifting mostly the exoskeleton's own weight and using positive acceleration feedback to hide inertia from the operator (Sec.~\ref{update:intro}).}
		
\reviewer{``the system''---you mean the operator?}%
%
\response{This sentence was removed for brevity (Sec.~\ref{update:intro}).}
		
\reviewer{is the ``extender'' just another name for a ``force amplification robot''? if so, make it clear}
\response{The discussion of the extender concept (and the need to draw a distinction between this and amplification exoskeletons) has been removed from the paper (Sec.~\ref{update:intro}). But extenders are indeed a type of amplification exoskeleton, in that they provide a disparate compliance for the human-side and environment-side fo the robot. }
		
\reviewer{``this research''---``this'' referes to the previously mentioned research or the author's contribution?}
		
\response{It referred to the previous literature. This sentence was ultimately rewritten (Sec.~\ref{update:intro}).}	
		
\reviewer{``amplification claim of the extender''---``extender'' now refers to the work in [23] or also work presented here?
			
further, which ``amplification claim''? by now, two are already identified: ratio of the two cylinder areas and ratio of two admittances
}
%
\response{Extenders are no longer explicitly discussed (Sec.~\ref{update:intro}). But \cite{KazerooniGuo1993JDSMC} is indeed our reference for the definition of the extender approach, and the mentioned amplification claim was that of extenders.}
		
\reviewer{``With no forcefeedback to make the environment-side port of the exoskeleton
more compliant than the low-level position controller''---this needs to be rephrased, as now it is comparing compliance of the exoskeleton port with a controller, which makes no sense.
			
my understanding is that the authors want to say that the environment side of the exoskeleton can be made more compliant using force-based controller compared to a simple position controller. however, the sentence is certainly not saying this}
%
\response{This sentence has been removed (see  Sec.~\ref{update:intro}), and the idea is now more clearly explained in the admittance control paragraph.}


\reviewer{``Low level force control is a more direct way
to achieve backdrivability''---authors earlier discussed about ``high level compliant behavior'' and then here say - seemingly refering to that compalince - that ``low level force. . . to achieve backdrivability''
			
as mentioned in another comment: compliance is not to be identified with backdrivability}
\response{These concepts have been more clearly distinguished, and the original sentence has been removed (see Sec.~\ref{update:intro}).}

\reviewer{this whole paragraph, it seems to me, interchangeably uses ``compliance'' and ``backdrivability'' (incorrect!) and leaves the reader confused which backdrivability here it refers to.}
\response{Compliance and backdrivability are now more clearly distinguished, and this whole paragraph has been replaced (see Sec.~\ref{update:intro}).} 

\reviewer{\label{rev7:buried_contribution}this is the contribution of the paper, but it is buried in the long text, and weakly expressed by using ``(this paper)'' - this needs to be very clear and stand-out}

\response{The contributions of the paper have been made clearer, and the flow of the introduction now highlights improving the compliance relative to the `gravity compensation baseline' (Sec.~\ref{update:intro}).}	

\reviewer{``Additionally, these works exploited a fixed based,''---it is unclear what this means}
\response{Our earlier testbed papers took advantage of a rigid attachment to a lab-bench. The sentence was ultimately removed for brevity (Sec.~\ref{update:intro}).
}

\reviewer{a good part of the left column deals with force, position and admittance control, but in a confusing way, to the point that I have lost track of what is the point you are trying to make here}
\response{The discussion of admittance control has been greatly clarified in Sec.~\ref{update:intro}. Force and position control are now also discussed more clearly but play a less significant role.}


\reviewer{\label{rev7:intro_signpost}
given that this paper does not have a typical intro-materials and methods-result-conclusion structure, I highly suggest adding a paragraph here ``The remaining of the paper is organisied as follows. . . '' to give a guidance to the reader on how to put everything into perspective}
\response{To satisfy the competing goals of this remark and Rmk.~\ref{rev7:intro_length} on the introduction's length, structural organization is exposed in the final paragraph of the introduction (see Sec.~\ref{update:intro}) but does not have a dedicated paragraph beginning with ``The remaining of the paper is organized as follows.'' We wrote such a paragraph, but it felt redundant following the previous paragraph---so we combined them.}


\reviewer{\label{rev7:connecting_sentences}it would also be good to ``connect'' different sections, as right now, they do not necessarily come as expected}
\response{We have paid special attention to the inter-paragraph flow in the introduction (see Sec.~\ref{update:intro}).}


\subsubsection*{On Sec.~\ref{sec:theory}, Theory of Strength Amplification Tasks}
\reviewer{I suggest moving Table later in the text, it is not usual to have the table first thing after section title. the same holds for other tables}
\response{These tables have been moved later into their respective sections. References to the tables are now placed near the first use of the notation in each section.}

\reviewer{\label{rev7:which_task}which task?}
\response{In the area you highlighted, we were attempting to define a new type of task. To clarify, we've added more background on tasks so that the new task's differences would be clearer.
	
We now introduce the concept of a task in a leading way:}
\paperquote{
We are interested in the way the human perceives the environment once the controller has been defined\ra{---we}\ta{. We} want to define a control \ta{that} increases the magnitude of the human forces relative to the magnitude of the environmental forces within the context \ra{of the task}\ta{of, to borrow a concept from whole-body control for humanoids \cite{SentisParkKhatib2010TRO},} a task.
}
\response{Which sets up the following new paragraph on the concept of tasks. Concrete examples should make this abstract concept clear even to those readers who are unfamiliar with whole body control.}	
\paperquote{
\ta{Tasks describe behaviors we want the robot to achieve, for example moving an end effector to a desired pose in Cartesian space. The example task constrains 6-DOF, but it could also be divided into sub-components that preserve the DOF count, e.g. a 3-DOF position task and a 3-DOF orientation task.
	Tasks can also specify the desired internal forces of multi-contact \cite{KimEA2016TRO}.
	More generally, tasks define both an effort-flow port of the robot and a target behavior for the robot to imitate at that port---a spring-damper behavior for position control and a force behavior for force control. This port is known as the task-space. By using the mapping between the joint-space of the robot and the task-space (and the mapping's Jacobian, $J_t$), a whole-body controller can implement the task behaviors even while floating in zero gravity or maintaining contact with arbitrarily shaped ground \cite{SentisParkKhatib2010TRO}. 
}
}
\response{And now, with this more solid foundation, we can correct the ambiguity in the derivation. This should make both the topic (a new `amplification' subtype of tasks) and the point (to define its behavior) clearer. We've also combined the derivation into a single paragraph:}
\paperquote{
\ra{Looking at the task-space,}\ta{An amplification task will also shape the behavior in its task-space. Assuming this task-space is acted upon by both a human (through a sensorized cuff) and an external force, the open-loop task-space dynamics can be written}
\begin{equation}
\Lambda_t (\ddot x_t - \dot{J}_t \dot q) + \bar{J}_t^T (B_e + g_e) = \bar{J}_t^T(\tau +J_c^T f_c + J_e^T f_e),
\end{equation}
where $\Lambda_t = (J_t M_e^{-1} J_t^T)^{-1}$ is the \ra{operational }\ta{task-}space mass matrix and $\bar{J}_t = M_e^{-1} J_t^T\Lambda_t$ is the dynamically consistent pseudo-inverse of the task Jacobian \ta{\cite{KimEA2016TRO}}. \ta{An amplification task will reshape these dynamics to the human's benefit by applying the following ideal task behavior:}
\ra{Specifying the new behavior in only this task, we define the ideal \ta{amplification} task law as}
\begin{equation}
\bar{J}_t^T \tau = (\alpha-1)\bar{J}_t^T J_c^T f_c + \bar{J}_t^T(g_e),
\end{equation}
where the first term represents amplification of the human operator's \ra{influence on the task}\ta{strength}, and the second term \ra{removes the gravity bias}\ta{compensates gravity}.
\ta{This controller yields the closed-loop task-space dynamics,}\ra{
	With this controller,}
\begin{equation}
\Lambda_t (\ddot x_t - \dot{J}_t \dot q) + \bar{J}_t^T (B_e) = \alpha \bar{J}_t^TJ_c^T f_c + \bar{J}_t^TJ_e^T f_e.
\end{equation}
\ta{These closed-loop dynamics amplify} the influence of the human force by a factor of $\alpha$\ra{, but is}\ta{. But this behavior is complicated by the projection matrices $\bar{J}_t^TJ_c^T$ and $\bar{J}_t^TJ_e^T$, which represent projection onto the space of the task as well as}\ra{ complicated due to} the potential \ra{mismatch between the task definition, the human cuff locations, and the location of any environmental forces}\ta{for mismatch between the reference frames of the task, the cuff, and the external force}.
}
		%%%%%%%%%%%%%%%%%%%%%%%
\reviewer{what are the implications of this assumption for generality of the controller?}
\response{The assumption that the human and environment act only in the task-space is a special case, but the reference frame match can be assumed without loss of generality. This is reflected in the updated paragraph:}
\paperquote{
\ta{To more clearly represent the special case where the human and environment forces act \emph{only} in the task-space, let us assume, without loss of generality, that the human and environment forces are expressed in the units and reference frame of the task-space.}
\ta{For example, this is the case if: (1) both forces are applied to one sensorized, 6-DOF end effector; (2) the sensor measurements of the spatial force vectors of the human and the environment are all converted to the same reference frame \cite{Featherstone2014Book}; and (3) this frame is also the frame in which the task is expressed.} \ta{This special case leads to \emph{ideal}} amplification behavior.
}

\reviewer{\label{rev7:footnote_assumptions}``We can also see that the $x_t$ solutions to the above differential equation, if we assume it is linear\footnote{As would be very nearly the case if the magnitude of motion was small, the velocity was near zero, and the robot was far from any singularities.}, is the sum of the solutions for the two inputs ($f_c$ and $f_e$) independently.''---how realistic is this assumption for the real-case scenario?}
\response{This is addressed in Sec.~\ref{update:linear_analysis_limits}.}
	
	
\reviewer{\label{rev7:human_side_env_side}``And this leads us to define
	amplification as the ratio of compliance transfer functions
	between the larger human-side compliance and the smaller
	environment-side compliance.''---explain what exactly is  considered by ``human side'' and ``environment side'' compliance. a physical interface? control interface? both?}
\response{This is addressed in  Sec.~\ref{update:linear_analysis_limits}.}

\reviewer{``that the compliance of the human is higher ''---human compliance higher than what?}
%
\response{Higher than the environment-side compliance was the original intent. We resolved this confusion by recasting in terms of the amplification transfer function. This should also help motivate the transition to the frequency domain section.}
%
\paperquote{
We call this law ideal because \ta{it} changes the apparent inertia the human feels instantaneously---which is quite a simplification\ta{. The law requires that the actuation bandwidth is infinite}.
\ta{Beyond the actuation bandwidth, all feedback systems asymptotically revert to their natural dynamics. Thus, in the high frequency asymptote, the two compliances should be equal; and their ratio, the amplification \emph{transfer function}, should equal one. To design realizable amplification behaviors while satisfying these requirements, we will employ frequency domain tools.}
\rb{Since Newton's laws don't discriminate between forces based on their origin,  the amplification \emph{transfer function} must inevitably approach an egalitarian high-frequency asymptote.}
\ra{In the frequency domain, this is equivalent to claiming that the compliance of the human is higher at all frequencies and that the actuation which renders a magnification of the sensor force suffers no phase lag from either time delay or low level bandwidth limitations.}
}

\subsubsection*{On Sec.~\ref{sec:fd}, Shaping Amplification in the Frequency Domain}


\reviewer{``compliance which will be stable when rigidly attached to the
human operator.''---is this to say that the compliance you are modifying is only stable with the assumption of a rigid human-robot connection? this connection is never rigid - it is actually another compliance in itself. how does that affect your calculations and your approach?}
\response{This wording has been modified to reflect the fact that the human model can safely be assumed to lump together the compliance of the physical interface, the compliance of the human's own flesh, and the compliance of the human-musculoskeletal-system's position tracking.}
\paperquote{
To help us in this \ta{endeavor} we draw upon a set of Bode plot tools \ta{collectively known as the compliance shaping approach.} \ta{These tools will allow us} to design a compliance \ta{that} will be stable when \ra{rigidly attached to the human operator}\ta{coupled to a simple model of the operator. This model lumps together the spring-like effects of the cuff structure, the operator's biological soft tissue, and the operator's musculoskeletal system}.
}



\reviewer{``with units of force per
	position---a spring''---force per position = spring stiffness, not spring}
\response{Changed. The sentence is now: ``A compliance under proportional feedback has a controller with units of force per position---a spring \ta{stiffness}.''}

\reviewer{\label{rev7:human_as_spring}please explain in which sense ``the human behaves similarly to a spring''}
\response{This is addressed in Sec.~\ref{update:linear_analysis_limits}.}


\reviewer{\label{rev7:physical_interface_compliance}my understanding is that you are not taking into account (physical) interface compliance, which will certainly have an affect on not only the total human-robot compliance, but also on the system's stability, responsivness, and effectiveness. can you comment on this, if not before, in the Discussion?}
\response{Since interface compliance is significant, we must include it as part of the ``human''---see Sec.~\ref{update:linear_analysis_limits}.}

\reviewer{``a ``human phase margin'' equal to $\angle C_H(j\omega)+\phi -180^\circ$''---
shouldn't this be $\angle C_H - \phi + 180$
	
in that case, if phase lag at the crossover freq is e.g. -120, comparing simply to -180 would be 60 deg margin:
-120 + 180 = 60
	
comparing to phi - 180, with e.g. phi = -20 would be 
-120 + 20 + 180 = 80 deg}
\response{Yes. Amended to: ``a ``human phase margin'' equal to $\angle C_H(j\omega)\ta{-}\phi \ta{+}180^\circ$.''
}

\reviewer{[On Fig.~\ref{fig:block_diagrams}]this whole left colum is to crowded. add more white space between different sub-figures and, if there is a name to the figure (as is the case with the sub-figure G), write that name in line with the sub-figure indicator (G), not above it}
\response{Corrected, as shown below. Green highlights the white space of the new design.}
\resizebox{\textwidth}{!}{%
\input{response_letter_fd_fig.pdf_tex}}

\reviewer{[on Fig.~\ref{fig:oneptune}]an arrow next to `tuning' means an increase in lambda? and different plots for Robot in the 2nd and 3rd column refer to the earlier lambda values? if so, explain this in the caption}
\response{This caption now reads as follows, and this excerpt also addresses Rmk.~\ref{rev7:remove_operator_side} and Rmk.~\ref{rev7:human_spring_phase_margin}.}
\paperquote{\footnotesize
One parameter tuning of the amplification filter. Three bode plots show three different tuning configurations as the single tuning parameter (the amplification bandwidth \ta{$\lambda$}) is increased to failure. \ta{Tuning arrows indicate increasing $\lambda$.} Plotted are the compliance of the human (Human), the \ta{human-side compliance} \ta{of the robot} (Robot), and the compliance of the two when interconnected in parallel (System). In all three bode plots, magnification is used to highlight the calculation of the ``\ta{Human Phase Margin}.'' This calculation uses the phase of (Robot) at the frequency where the magnitude of (Robot) is equal to the magnitude of (Human)---the crossover frequency. At this frequency, stability of the resulting human--robot interconnection is determined by comparing the phase of (Robot) to a reference phase $180^\circ$ offset from the phase of (Human). The difference between the phase of (Robot) and this reference is the ``\ta{Human Phase Margin}.''}

\reviewer{[on Fig.~\ref{fig:oneptune}]\label{rev7:remove_operator_side} ``the compliance of the robot's operator interface''---is this ``human-side compliance''? please be consistent in the terms you are using throughout the paper, otherwise it's confusing?}
\response{This has been changed in the caption excerpted above.}

\reviewer{[on Fig.~\ref{fig:oneptune}]\label{rev7:human_spring_phase_margin} ``Human Spring Phase Margin''---similarly, is this the ``human phase margin'' discussed earlier? if so, be consistent with the expression you are using. if not, please explain what this is}
\response{This has also been fixed in the caption excerpted above.}

\reviewer{``operator-side''---operator-side = human-side
	
	to avoid confusion, consider using the same phrase throughout the paper}
\response{This has been standardized to human-side.}

\reviewer{``spring'' refers to human as a spring in parallel to interface compliance? this is not clear}
%
\response{This has been clarified, and the following excerpt also addresses Rmk.~\ref{rev7:human_spring_phase_margin}.}
\example{Our controller exploits this assumption by having \ra{an operator}\ta{a human}-side compliance that asymptotically approaches $-180^\circ$ from below\ra{---which would be destabilized by all sufficiently stiff springs.}\ta{. Note that this means that there exist ideal springs which, in parallel with the human-side compliance, would destabilize the exoskeleton.}}




\reviewer{a `hat' is usually used to denote estimate - consider different notation to avoid confusion}
\response{While the hat operator has many potential meanings, it is actually this very meaning that I wanted to draw on. The approximation $\hat\alpha (s)$ is an estimate of the true $\alpha(s)$. This makes the meaning clearer than if I had used $\tilde\alpha(s)$---which would incorrectly imply some kind of difference---or $\alpha^\prime(s)$---which would suggest that there was a mapping or a derivative. There are more arcane options---boldface, fraktur, or script fonts and non-standard diacritics such as umlauts, cedilla, etc. But I think the IEEE audience is best served by the hat.}

\reviewer{``some imperfections''---how do you model these imperfections?}
\response{This is clarified:}
\paperquote{
The compliance with respect to actuation forces, $C_A(s)$, introduces some imperfections \ra{in control authority. We write these as}\ta{which we model as the transfer function $\eta(s)$:}
\begin{equation}
	C_A(s) = C_E(s) \eta(s).
\end{equation}
\ra{and the imperfections in $\eta(s)$}\ta{These imperfections} include a low pass filter restricting the bandwidth of the actuation, and a time delay. (A comparison between $C_E(s)$ and $C_A(s)$ is shown in the Bode plot of Fig.~\ref{fig:block_diagrams}.H.)
}

\reviewer{add definition of this parameter {\rm[$\lambda$]} to Table II
	
	also, is this what is called in Fig. 3 the ``amplification bandwidth'' parameter? if so, make sure to mention that here in the text}
\response{This has been added to the table.}
\paperquote{\begin{tabular}{rl}
		\ta{$\lambda$} & \ta{amplification bandwidth (tuning parameter)}\\
		\ta{$\alpha_0$} & \ta{steady-state amplification rate}\\
		\ta{$\zeta$} & \ta{amplification damping ratio}\\
		\end{tabular}}
\response{And the text has been updated:}
\paperquote{To facilitate easy tuning of our controller we introduce one parameter $\lambda$\ta{, the amplification bandwidth} (equal to $\omega_p$ which we tune, \textellipsis}

\reviewer{what is the difference between $\phi$ (human lag) mentioned earlier and in Table II, and $\phi_H$?}
\response{The redundant subscript H (for human) has been removed.}
	
\reviewer{please clarify, which should then also explain the difference in human phase lag (phi in -90 to 0, $\phi_H>0$) and the reference $\phi$ - 180 as compared to -180 - $\phi_H$ }
\response{This has been corrected to match the sign convention for $\phi$ adopted in the definition of human phase margin.}
\paperquote{
This frequency of intersection is the human crossover frequency, and the phase of the human-side compliance of the exoskeleton is compared to \ta{$-180^\circ+\phi$, where $\phi<0$ is the phase lag of the human compliance}. This \ta{human phase margin} determines whether the closed loop system will have a pole in the right half plane, as can be observed from its phase behavior in the Bode plot in Fig.~\ref{fig:oneptune}.
}

\reviewer{\label{rev7:parameter_adaptable}``We only need one tuning experiment per degree of freedom''---does this mean 1 experiment per DoF per task? is it possible to have this parameter adaptable? }
\response{This digression on tasks has been removed from this paragraph. But the automation of the tuning is now touched on in the discussion (see Sec. ~\ref{update:discussion}).}
\paperquote{
\ra{We only need one tuning experiment per degree of freedom to find the limit for any particular amplification shape.}\ta{A single tuning experiment can determine the limiting bandwidth for any particular amplification shape.}
}



\subsubsection*{On Sec.~\ref{sec:ift}, Inter-Foot Force Task}


\reviewer{$[$\rm The highlight between the section title and the notation table$]$}
\response{This table has been moved later in the section.}

\reviewer{``Human-led contact transitions are an important part of any scheme for controlling multi-contact exoskeletons, \textellipsis''---is this referring to walking, or more generally, human-initiated changing of balance from one leg to the other? please re-phrase and/or clarify}
\response{Clarified. The following excerpt also addresses Rmk.~\ref{rev7:multi_contact_multi_human_contact}.}
\paperquote{Human-led \ta{foot} contact transitions\ta{, such as walking or shifting balance,} are an important part of any scheme for controlling \ra{multi-contact}\ta{lower-body} exoskeletons, \textellipsis}

\reviewer{\label{rev7:multi_contact_multi_human_contact}multi-contact refers to multiple points of attachment to a human wearer? clarify and/or re-phrase as it is not clear what is meant with this}
\response{I've changed this to ``\ta{lower-body} exoskeletons'' (see previous excerpt) for clarity.}

\reviewer{what do you mean by ``they do not fall out of the strategy. . . naturally''? you mean that these transitions do not ``follow directly from'' the amplif strategy and need to be separately defined? if so, please be clear on this
}
\response{Clarified:}
\paperquote{\textellipsis , \ta{and they do not naturally emerge from the \ta{\emph{amplification task}} as one might hope.}}


\reviewer{clarify what exactly are ``net reaction forces between two feet''}
\response{Clarified:}
\paperquote{We define a \ta{virtual single foot contact} for the robot \ta{indirectly} by defining the way that \ta{the net reaction force would be split into two components, one for each foot}. \ta{This splitting is accomplished with the following equality constrained quadratic programming problem.}}

\reviewer{``To avoid tilting or sliding the contacts, \textellipsis''---contacts between the robot and the ground or the robot and human? be specific}
\response{This topic (contact constraints) has been moved to Sec.~\ref{sec:opt}. The paragraph has been removed, but we've also changed our choice of wording to avoid the ambiguous usage of ``multi-contact.''}


\reviewer{multi-contact with what/who?}
\response{This topic (contact constraints) has been moved to Sec.~\ref{sec:opt}, and the sentence was not kept.}

\reviewer{``Strength amplification for multi-contact robots can be thought of as a reduction to fixed based dynamics plus an application of the fixed base solution. However the virtual ``base''  can change with time.''---this part is confusing, consider re-phrasing and clarifying, and be consistent with the phrases used}
\response{This has been clarified.}
\paperquote{
\ta{With one foot on the ground, this foot acts as a virtual base for the exoskeleton---a contact constraint on its otherwise free-fall dynamics.
	Since the exoskeleton is not designed to jump, we can assume that some sort of virtual base always exists.}
When two feet are on the ground at the same time,
\ta{we can imagine a virtual single foot between them that acts like a base and moves between the feet according to the operator's own weight distribution.}
}


\reviewer{unclear what is meant by the ``model's environmental force reflection problem''
}
\response{This has been removed.}

\reviewer{I suggest you give a name to each of the two tasks and refer to them in italics - this will make it clear for the reader when you refer to any one task
	
	also, be consistent with the names, i.e. avoid using different names for the same thing (e.g. ``hip sensor force task'' and ``hip zeroing task'')}
\response{The tasks have been standardized to \ta{\emph{inter-foot force task}} and \ta{\emph{amplification task}}. I've also standardized the new reference frames as \ta{frame $s$} and \ta{frame $d$}.
}

\reviewer{is there a mistake here? a typo?}
\response{I've improved the typesetting on this multi-line equation to be clearer:}
\paperquote{\begin{align}
	f &= \ta{(Q^{-1}X^T)\cdot[XQ^{-1}X^T]^{-1}} f_s,\\
	\begin{pmatrix} f_1\\f_2\end{pmatrix} &= \begin{pmatrix}Q_1^{-1} {^sX_1^{*T}} \\ Q_2^{-1} {^sX_2^{*T}}\end{pmatrix}\nonumber\\
	&\ta{\rule{1em}{0pt}\cdot \begin{bmatrix} {^sX_1^*}Q_1^{-1}{\,^sX_1^{*T}}+{^sX_2^*}Q_2^{-1}{\,^sX_2^{*T}}\end{bmatrix}^{-1}} f_s\ta{.}
	\end{align}}


\reviewer{``simultaneously accomplishing amplification at the hip''---this is very important point but this is the first time it is mentioned. move this information to Introduction
	
as a matter of fact, this entire paragraph is crucial - a simultaneous execution of two tasks is how this exoskeleton is operating, and this should be highlighted in the introduction}
\response{The introduction now makes clear that the exoskeleton performs these two tasks simultaneously (see Sec.~\ref{update:intro}). This is also mentioned again in the beginning of the section: ``To allow this critical feature we introduce a \ta{second task that is simultaneously achieved, the \ta{\emph{inter-foot force task}},} which causes the exoskeleton to follow \ta{human-initiated foot lifting}.'' However, the rest of the highlighted paragraph is essentially presenting a reaction-force-centric alternative view of how the system operates, so I've given it its own subsection of section IV to highlight its significance without distracting from the flow of the introduction. The following excerpt also addresses Rmk.~\ref{rev7:very_important_info}.}
\paperquote{%
\noindent\emph{\ta{Interpreting the Controller Through Reaction Forces:}}
	
%% High leve explanation moved up from the IFT section%% High leve explanation moved up from the IFT section
\ta{As mentioned in Sec.~I, our exoskeleton controller is tasked with \emph{simultaneously} accomplishing the \ta{\emph{amplification task}} \ta{at the hip/backpack interface} (Sec.~\ref{sec:fd}) and the \ta{\emph{inter-foot force task}}.}
\ta{In terms of reaction forces, the \ta{\emph{amplification task}} serves a similar purpose to the centroidal momentum task introduced in \cite{KoolenEA2016IJHR} or the center of mass task in \cite{SentisParkKhatib2010TRO}: it determines the required \emph{sum} of reaction forces.
	Meanwhile, the \ta{\emph{inter-foot force task}} (similar to the internal force tasks from \cite{KimEA2016TRO}) determines the part of the reaction force vector that is decoupled from the center of mass acceleration.}
With both tasks active, the reaction forces are all defined and the joint torques can be thought of as resulting from an inverse dynamics process---as in the Dynamic Balance Force Control of \cite{StephensAtkeson2010IROS}.
}
	

\reviewer{\label{rev7:very_important_info}very important information, make sure it is highlighted better in your work}
\response{This is now highlighted in a short subsection (see previous excerpt).}


\subsubsection*{On Sec.~\ref{sec:opt}, Weighted 1-Norm Shared-Body Control}

\reviewer{``Our approach to this problem is to prioritize the tasks.''---this too is a piece of information that should find its place in the introduction}
\response{This has been included in Sec.~\ref{update:intro}. (In particular, we now write \ta{[\textellipsis] (a) an optimization-based controller that determines robot joint torques using a prioritized list of `tasks' and a set of constraints that act on the sum of human and robot torques---the `Shared-Body Controller' (Sec.~\ref{sec:opt});[\textellipsis]}.)}

\reviewer{``For example, the following two tasks and set of inequality constraints can (and often do) conflict: the task to apply zero lateral (y-axis) hip force to the human, the task to apply zero roll rotation (x-axis) about the hip, and the inequality task to maintain forces within the friction cones of the two feet cannot be simultaneously satisfied when the center of mass is not above the support region of the contact state \cite{BretlLall2008TRO}.''---please rewrite this sentence for it is too long, but also incorrect: you say ``. . . constraints can conflict:. . .  [constraints] cannot be simultaneously satisfied. . . ''}
\response{This has been rewritten:}
\paperquote{
\ta{For example, the combination of the lateral (y-axis force) component of the \emph{amplification task}, the mediolateral-plane rotation (x-axis torque) component of the \emph{amplification task}, and the stance-foot's lateral center-of-pressure limitation may require a non-zero task error. This is easy to visualize if the robot's hip is far from the stance foot: the ground reaction force can point toward the hip and avoid rotation, or it can point straight up and avoid lateral force, but it cannot do both simultaneously. A more general version of this problem is well known in the humanoid robotics community \cite{BretlLall2008TRO}.}
}

\reviewer{``over-constraint''---[highlighted]}
\response{Changed:}\paperquote{
%%% Why we use Priorities
\ra{Without an analytical method to determine the relative desirability of the various solutions to the over-constraint problem, we must rely on our intuition and trial and error.}\ta{When constraints become active, there is neither an obvious choice for what to give up nor an analytical method to optimally decide.}
}

\reviewer{``eachother''---[highlighted]}
\response{Changed:}
\paperquote{
\ta{However, if we provide a \emph{prioritization} of the \ta{task sub-components}, then an optimal answer exists. This prioritization requires additional parameters---a rank order for each task sub-component---but these are relatively few, and easy to understand and adjust.}}

\reviewer{``survive the longest''---I suggest using a different phrase. this is very unusual phrase in this context}\response{Changed:}
\paperquote{
\ta{When constraints become active, the prioritization approach simply abandons the task sub-components one at a time, starting with the least important, until the problem is solvable.}
}

\reviewer{``this could mean both a failure to amplify the interaction force or a failure to achieve gravity compensation''---``both'' is followed by ``and'', not ``or''} \response{Changed:}
\paperquote{In the case of our \ta{\emph{amplification task}}, this could mean a failure to amplify the interaction force \ta{and/or} a failure to achieve gravity compensation.}

\reviewer{the authors mentioned earlier 2 tasks - hip zeroing task and difference task. now they are talking about more than two tasks - possibly identifiable as sub-tasks? 
	
in any case, the authors are suggested to clearly identify and specify all the tasks they refer to by ``tasks'' as it is otherwise confusing}
\response{The \ta{\emph{amplification task}} and \ta{\emph{inter-foot force task}} are now each composed of six sub-components. These components correspond to the components of a 6-DOF spatial force vector. (i.e. there are three force components (x, y, z) and three torque components (Tx, Ty, Tz).) The text has been changed to avoid referring to a component of one of the tasks as a task. They are now called task sub-components.}

\reviewer{``12 tasks''---as mentioned in an earlier comment, these tasks - or sub-tasks should be clearly identified}
\response{Changed.}
\paperquote{
In our hardware, we could \ta{only solve three lexicographic optimization sub-problems within our one millisecond real-time control window, so} with \ta{12 prioritized task sub-components, a proper lexicographic solution} was outside the realm of plausibility.
}

\reviewer{``scalaraization''}
\response{Changed: \ta{scalarization}.}

\reviewer{this paragraphs is not clear as a whole. it seems there is a confused use of task, sub-task, problem, sub-problem, i.e. it is not necessarily clear to which task, sub-task etc the authors are referring to
	
also, some parts do not make sense, e.g. in the 1st sentence ``. . . tasks operating with the solution prior problems acting as constraints''}
\response{This paragraph has been merged with an earlier paragraph and rewritten for clarity:}
\paperquote{
%%% Speed Issues with straight lexicographic approach
Strict prioritization between the tasks is a mathematically well-defined optimization scheme known as lexicographic optimization \cite{BouyarmaneKheddar2017TAC}. %%% Sim Speed comparison?
\ta{Lexicographic problems must be solved as a series of related optimization sub-problems. First, the most important cost must be optimized within the problem constraints---the first optimization sub-problem. Next, the second most important cost must be optimized within both the original problem constraints and a new constraint.
	This new constraint requires that the previously minimized cost for the most important objective stays at its previously determined optimal value.
	With a solution to this second optimization sub-problem, a lexicographic optimization would proceed forward one cost at a time, solving optimization sub-problems with an ever-increasing list of constraints.
	And this recursive process will continue until each component of the prioritized list of costs has been optimized in its own sub-problem.%
}
%However, to solve a lexicographic problem entails great computational work. Linear lexicographic costs with linear constraints and inequalities require solving one linear programming problem for each level of cost hierarchy.
In our hardware, we could \ta{only solve three lexicographic optimization sub-problems within our one millisecond real-time control window, so} with \ta{12 prioritized task sub-components, a proper lexicographic solution} was outside the realm of plausibility.
}

\reviewer{``The lexicographic optimum for a cost that prioritizes horizontal error infinitely over vertical error coincides with the optimal solution for cost B, and the same is true of the opposite lexicographic ordering and cost A. ''---this sentence is not clear
	
	also, does
	prioritise = penalise or?
	please clarify}
\response{This sentence has been removed, and the paragraph reworked:}
\paperquote{
% 2D intuition about this approximation strategy
To capitalize on this 2D intuition, Fig.~\ref{fig:onpwbc} illustrates how the weighted 1-norm cost can be adjusted through the weighting to approximate different lexicographic costs (there are only two in 2D space\ta{: either $x$ matters more than $y$ or vice versa}). The illustration features a convex 2D set of solutions which satisfy constraints. The two axes represent orthogonal tasks, with the origin representing \ta{zero error for} both tasks. Cost A uses a weighting that penalizes $y$ error more than the $x$, cost B penalizes them roughly equally\ta{, and cost C penalizes $x$ error more than $y$}. In both cases \ta{A and C}, the minimum cost point which satisfies constraints \ta{falls on one of the two axes---exactly as a lexicographic solution would.} The fact that 1-norm costs tend to produce \ta{solution vectors with many zero entries (so-called ``sparse'' solutions \cite{CandesWakinBoyd2008JFAA}) is well known and frequently exploited. To promote \emph{lexicographic solutions} instead of simply solutions with many zeros requires tuning the penalty weights to favor the prioritized tasks.} 
In our illustration, \ta{the weightings in A and C are sufficiently extreme, and two lexicographic solutions emerge}.
Cost B illustrates \ta{a non-lexicographic middle-ground: neither cost is penalized enough to completely dominate the other, and the solution vector assigns non-zero error to both tasks.}
}

\reviewer{``We call this a priority inversion event, and one of our goals in setting up the prioritization is to minimize the chance that they occur.''---please clarify how is this going to be achieved}
\response{This has been clarified:}
\paperquote{
% Limitation in switching
One disadvantage of weighted 1-norm costs in robot control is that the constraints are continuously varying due to the changing robot geometry, and this can cause the optimal behavior to jump discontinuously.
This can occur if the 1-norm cost discontinuously switches from being aligned with one lexicographic solution to a different lexicographic solution or even a non-lexicographic solution.
\ta{We call these abrupt switches ``priority inversion events.'' To avoid these events entirely, we would need 1-norm weights with near-infinite scale differences between task sub-components. Since this is obviously not possible with floating-point numbers, the weighted 1-norm is an approximation: it sacrifices accuracy for speed.}
Fortunately, the approximation of the lexicographic problem is asymptotically perfect as the weight discrepancy increases, and the numerical precision of the linear program solver allowed us sufficient space to set these weights orders of magnitude apart and achieve reliable reproduction of the lexicographic problem in practice.
}

\reviewer{``For this reason we can think of the 1-norm cost as having lost something important in exchange for its speed.''---this sentence is not clear: ``For this reason. . . ''}
\response{As shown in the excerpt above, this reason has been clarified.}

%% Page 11



\reviewer{it is not a good practice using the same phrase to start a sentence in two consecutive sentences:
	
In addition. . . }

\response{This paragraph has been re-written. The following excerpt also addresses Rmks.~\ref{rev7:for_example}--\ref{rev7:sentence_too_long_confusing}.}
\paperquote{
% Introduce composite Jacobian and force $\mathbf J$, $\mathbf f$, which combine ground contact with amplification contact
\ta{More specifically, we find $(f_a(\tau)^T, f_f(\tau)^T)^T$---the mapping from the 12-DOF joint torque vector to an 18-DOF vector of forces that concatenates the ground reaction forces with the human--robot interaction forces at the backpack.\footnote{\ta{Ultimately we only care about the 12-DOF vector of the \emph{inter-foot force task} error and \emph{amplification task} error, $(f_a(\tau)^T, f_d(\tau)^T)^T$ but the 18-DOF vector representation was more intuitive to debug. We will use the $\mathbf{G}$ matrix to obtain $f_d(\tau)$ from $f_f(\tau)$ later.}}
	We define a new composite Jacobian, $\mathbf J$, force vector, $\mathbf f$, and task acceleration, $\ddot{\mathbf x}$, as
}
}

\reviewer{\label{rev7:for_example}``for example'' is confusing in this sense. please specify all human-exo connections that exist in your case to avoid confusion.
	
are these the only 2 connections? if so, there is no need for ``for example'', but specify then that these are the only connections}
\response{Removed. See the excerpt above.}

\reviewer{\label{rev7:than_are}``than are''---you mean ``than the ones that are constrained''? please be clear in your presentation}
\response{Removed. See the excerpt above.}

\reviewer{\label{rev7:sentence_too_long_confusing}this sentence is way too long and confusing.
	
	please split into at least 2, or even 3 sentences}

\response{Removed. See the excerpt above.}

\reviewer{please reference the exact equations you are referring to}
\response{Changed:}
\paperquote{Beginning with the physical equations \ta{ \eqref{eq:physical_dynamics_1} and \eqref{eq:physical_dyamics_2}}, we can reformat the dynamics of the robot as a matrix equality with an analytic solution,}

\reviewer{``passive joints''---which and how many are they?}
\response{Added mention of passive joints to the introduction, and added a footnote: ``\ta{The exoskeleton has 2 passive DOFs per leg: ankle inversion/eversion (ankle roll) and internal/external rotation of the hip (hip yaw).}''}


\reviewer{this whole paragraph from the eq. 40e definition to ``We call this program. . . '' needs to be re-written. when you start with ``These functions are based on'' the reader expects a `list' of things, but simply adding an equation after comma, as is the case with the eq 41, does not make a correct list. also, it is not clear where does ``$f_r$'' come from just under the eq 41, nor how does the ``recalling the matrix G. . . '' sentence fit into the start of this part from the ``These functions. . . ''.
	
further, for clarity, please reference specific equations you are referring to, not e.g. ``from the definition of the amplification task in Sec III'' to avoid confusion}
\response{This paragraph has been rewritten to both improve clarity and include more explicit equation references:}
\paperquote{\setcounter{equation}{39}
%% Optimization problem
\ta{We write our optimization problem,}
\begin{subequations}
	\begin{align}
	&\underset{\tau, s_+, s_-}{\mathrm{minimize}}
	&& w^T s_+ +  w^T s_- \label{eq:general_opt}\\
	&\text{subject to}
	&&C_r f_r(\tau) \geq 0,\label{eq:contact_inequalities_in_opt}\\
	&&& \tau \leq \bar{\tau},\qquad -\tau \leq \bar{\tau},\\
	&&& s_+ \geq e(\tau), \qquad s_+\geq 0,\label{eq:slackplus}\\
	&&& s_- \geq -e(\tau), \qquad s_-\geq 0,\label{eq:slackminus}\end{align}
\end{subequations}
\ta{with some new notation from Tab.~\ref{tab:not4}. Slack variables $s_+$ and $s_-$ are introduced to describe absolute value operations. Weightings $w$ form the weighted 1-norm cost. Limits on absolute torque are expressed with $\bar\tau$. And the $\tau$-dependent vector $f(\tau)$ from (38) (or from the steady-state approximation (39)) is used to find $e(\tau)$ and $f_r(\tau)$.}

\ta{The first, $e(\tau)$, represents the 12-DOF vector of task errors for the \emph{amplification task} and \emph{inter-foot force task}:}
\begin{gather}
e(\tau) = \begin{pmatrix} f_d(\tau) \\
f_a(\tau) - f_a^d \end{pmatrix},\label{eq:e_def}
\end{gather}
\ta{where $f_a^d$ is the desired amplification task force from \eqref{eq:amplification_task_desired} in Sec.~\ref{sec:fd_task}; $f_a(\tau)$ is the force the robot applies at the backpack interface, which is a part of $f(\tau)$ as written in \eqref{eq:bigJdef}; and $f_d(\tau)$ is also related to $f(\tau)$ as in \eqref{eq:G_use}:}
\begin{gather}
\begin{pmatrix}
f_s(\tau)\\f_d(\tau)
\end{pmatrix} = \mathbf G^{-1} f_f(\tau),
\end{gather}	
\ta{using the matrix $\mathbf G$ from \eqref{eq:G_def}. }

\ta{The second, $f_r(\tau)$, represents the subset of the foot forces $f_f(\tau)$ corresponding to the feet that are actually on the ground. 
	This vector is used to compute the constraints associated with hard friction cones and unilateral contacts---i.e. \eqref{eq:contact_inequalities}, which is directly reproduced in \eqref{eq:contact_inequalities_in_opt}.}
}

%% End page 11

		
\subsubsection*{On Sec.~\ref{sec:exp}, Implementation in Hardware}	

\reviewer{it beats the purpose having a figure on page 1 and its description on page 12. please put a figure here, maybe a more detailed one, so that the reader can easily follow the text and refer to the figure}
\response{This figure has been moved to the same page on which it is referenced. A new figure is used in the introduction.}

\reviewer{this word-composition is hard to understand, so please re-phrase}
\response{Rephrased:}
\paperquote{
Note that when a \ta{component of the \emph{amplification task}} has $K(s)$ set to zero, it \ta{will not amplify human forces but will still compensate gravity.}
}

\reviewer{what exactly is meant by the ``backpack-exoskeleton force/torque sensor''?}
\response{Clarified:}
\paperquote{
To summarize the tasks of the controller, the six individual \ta{spatial force vector} components \ta{of the human-side force} are fed into a diagonal matrix of amplification compensators as described in Sec.~\ref{sec:fd}. \ta{And this occurs in the frame of the \emph{amplification task}---the hip frame.}
}

\reviewer{it is confusing when two instances of ``which'' are used so close to each other, so please consider re-phrasing
	
	also, the second part of the sentence ``which essentially identifies. . . '' is not clear. to avoid using what exactly? 
	
	or you mean ``identifies two grounding which are not to be used''?}
\response{Clarified:}
\paperquote{
With the exoskeleton and massless operator hanging from these grounding points, the job of the exoskeleton is to choose the joint torques that minimize some cost\ta{, and this cost essentially identifies two groundings to avoid using (Fig.~\ref{fig:cartoon}.e).}
}

%% end page 12 begin page 13

\reviewer{[On Fig.~\ref{fig:cartoon}]the way sub-figures are placed makes the whole figure a bit confusing.
	
	I would suggest to make a clear distinction (white space) between the rows and columns (i.e. a table-like division) and that sub-figures are well aligned (e.g. sub-figure B's top is higher that sub-figure D's bottom which is confusing).
	
	also, each of the sub-figure is assigned a letter (a-e) and a name, but these are not put togeter. in other words, you should write e.g. 
	
	b. Exoskeleton (and the picture bellow)
	
	and not
	
	Exoskeleton
	
	b.}
\response{The figure layout has been amended with increased white space, and the title text is now formatted to continue the letter-enumerator. The following excerpt also addresses Rmk.~\ref{rev7:cartoon_fig_caption}.}
\paperquote{\def\svgwidth{\columnwidth}\noindent\input{exo_cartoon.pdf_tex}
	
	\footnotesize\noindent Fig.~\ref{fig:cartoon}.\ \ \ta{
To visualize our optimization problem's behavior, we consider our exoskeleton (a) and the difference between its real force sensor configuration (shown in b) and the three human interfaces the optimizer cares about (shown in c). The optimizer treats the operator as massless and assumes the three interfaces are contact constraints (d). The optimizer is aware of the mapping between the exoskeleton joint torque vector and the reaction forces at the three constraints. With the exoskeleton and massless operator hanging from these grounding points, the job of the optimizer is to choose the joint torques that minimize the cost function\ta{, and this cost essentially identifies two groundings to avoid using (Fig.~\ref{fig:cartoon}.e).} The result is that the cost function guides the exoskeleton to support the system's weight from the stance foot, at least when this does not conflict with the foot contact constraints or joint torque limits. While not explicitly pictured, the \emph{amplification task} simply shifts the ``zero'' point for the cost function's penalty on the e.0 contact (measured by the b.0 force/torque sensor, and felt by the operator through the c.0 backpack attachment).
}}

\reviewer{[On the caption of Fig.~\ref{fig:cartoon}]\label{rev7:cartoon_fig_caption}with a figure of this kind, where there are multiple sub-figures with coloured scheme, it is very useful to have a caption providing the text sufficient and necesary to understand the figure. hence, the authors are suggested to bring some of the text from their paragraph describing this figure into the caption of this figure}
\response{Clarified in the caption of the excerpt above.}




\reviewer{which parameters?}
\response{Clarified:}
\paperquote{The main \ta{drawback of the priorities from Tab.~\ref{tab:priorities}} is that at each stance transition the hips of the device roll such that the stance hip is higher than the swing hip---likely due to the lower penalty on hip amplification $x$-torque.}

\reviewer{reference the exact equation}
\response{Added and clarified:}
\paperquote{
We made a slight modification to the sum scalarized cost for the \ta{inter-foot force task} \ta{as described in \eqref{eq:general_opt}, \eqref{eq:slackplus}, \eqref{eq:slackminus}, and \eqref{eq:e_def}}. \ta{A second copy of the task penalty was added, with a dead zone. We made the \emph{inter-foot force task} error appear \emph{twice} in the task error vector $e(\tau)$ instead of only once as in \eqref{eq:e_def}. Thus, we had two separate components of the weight vector $w$ from \eqref{eq:general_opt} that penalized the same task. To introduce the dead zone for the second copy of the penalty, we added a sparse bias vector to \eqref{eq:slackplus} and \eqref{eq:slackminus}. We call this new penalty, with its dead zone and higher penalty cost, the ``Limit Penalty'' (see Tab.~\ref{tab:priorities}) since it acts like a soft limit forcing the values to stay within the dead zone.} \ta{Within the dead zone, this new cost still behaves like the original weighted 1-norm cost (plus a constant bias that does not influence the optimum), but at the boundary of the dead zone, the weight suddenly becomes much higher.}
}

\reviewer{SBC - shared-body control? please provide the meaning}
\response{Added a note:}
\paperquote{\begin{minipage}{2in}\centering
		\begin{tabular}{cccc}
			\toprule
			Test & SBC\ta{$^\dagger$} & $\alpha_0$ & Load\\
			\midrule
			\ref{subs:amp}.1 & Off & 0 & 0 N\\
			\ref{subs:amp}.2 & On & 0 & 0 N\\
			\ref{subs:amp}.3 & On & 0 & 110 N\\
			\ref{subs:amp}.4 & On & 3 & 110 N\\
			\bottomrule
		\end{tabular}
		\vspace{.5em}
		
		\ta{\scriptsize$\dagger$---Shared-Body Controller (SBC) enabled.}
		
	\end{minipage}}


\reviewer{add axis labels (x,y,z) to avoid any confusion
	
	[this was only added later explaining Fig 9 but should be here as well]}

\response{Axis labels have been added to the image.}

\reviewer{[``penalty penalty'']}\response{Corrected.}

% End page 13 being page 14

\reviewer{[Fig.~\ref{fig:experiment} caption]\label{rev7:exp_fig_caption_story}similar to earlier comments on the figure - a figure with so many sub-plots, trajectories and colours needs to be accompanied by a relevant caption. the reader needs to be able to understand the figure from looking at it and reading caption, instead of looking for a paragraph in the text that explains the figure. if there are too many details, then at least basics need to be provided in caption}
\response{This is addressed in Sec.~\ref{update:experiment_figure}.}

\reviewer{[On Fig.~\ref{fig:experiment}]\label{rev7:arrows_crossing_fig_boundaries} the expected Fz force is the thing of VI-D.3 experiment, but the arrow is crossing both D.2 and D.3 experiment Fz graphs. if the arrow has nothing to do with D.2 it needs to be removed from the 2nd column. if, on the other hand, it does related somehow D.2 and D.3, this needs to be explained in the caption of the figure (if I am not mistaken on what the authors want to show, would not simply a vertical arrow from the measured to the expected Fz in D.3 suffice? it would certainly make the plot clearer)
}
\response{This is addressed in Sec.~\ref{update:experiment_figure}.}

\reviewer{[On Fig.~\ref{fig:experiment}]\label{rev7:signs_of_joint_angles} signs of joint angles and torques/forces need to be clearly defined. e.g. is ankle flexion positive or negative?
	
	also, I suggest you move this legend off the graphs as this will allow a decrease in y-axis of the torque graph and thus better quality (easier-to-read) graphs}
\response{This is addressed in Sec.~\ref{update:experiment_figure}.}

\reviewer{[On Fig.~\ref{fig:experiment}]\label{rev7:torques_and_angle_sensors} how are these torques and angles measured?}
\response{This is addressed in Sec.~\ref{update:experiment_figure}.}


\reviewer{[On Fig.~\ref{fig:experiment}]\label{rev7:rad_to_deg} I suggest you change [rad] into [deg]. angles in [rad] are not straightforward to understand}
\response{This is addressed in Sec.~\ref{update:experiment_figure}.}


\reviewer{[On Fig.~\ref{fig:experiment}]\label{rev7:pare_down_angles} are all these angles relevant for the point you are trying to make? as it is now, it is very hard to read these graphs.
	
maybe only focus on the most important joint angles and torque? or just the ones that are changing the most? there is no point in showing all these trajectories if most of them remain unchanged. just mention somehwere in the text or figure caption that all other trajectories not shown do not change.}
\response{This is addressed in Sec.~\ref{update:experiment_figure}.}

\reviewer{[On Fig.~\ref{fig:experiment}]\label{rev7:whats_up_with_squat} what is the cause of the sudden change in the hip and knee joints' FE angles?
	
	is this the half-squat show in the video? if so, please do mention that here and provide any further explanations needed
}
\response{This is addressed in Sec.~\ref{update:experiment_figure}.}

\reviewer{how much torque is then left for the exo to amplify human strength? is it possible to quantify this?}
\response{Unfortunately, the remaining strength of the exoskeleton is very complicated to determine analytically or numerically: it is a function of nonlinear transmission ratios, contact, kinematics, and actuator heat-accumulation. We've added a sentence to the next paragraph to give a sense of how we worked around this limit.}
\paperquote{
In test \ref{subs:amp}.3, we added an 11 Kg (25 lb) mass to the backpack, without changing the control mode. \ta{Based on our empirical determination, this represents the maximum load the exoskeleton could reliably handle without overheating during dynamic motions like walking.}
}

\reviewer{I find it hard to understand that the weight of the exoskeleton was felt by the user (captured by the sensor), while adding extra weight to the exoskeleton was not captured by the sensor, although you claim was felt by the user. can you discuss more on this? 
	
further, did the user confirm that the weight was actually felt in Z axis?}
\response{Yes, this has been expanded:}

\paperquote{
We see some unexpected behavior in the vertical sensor force: the weight's 110 N \ta{did not transfer to the sensorized interface}. \ta{The user confirmed that additional vertical force and sagittal torque were felt.} This suggests a ``force leak'' in the design of the backpack sensor, where the force of the added weight is transferred to the operator without passing through the sensor. A likely culprit is the hip-pad of the backpack (directly connected to the operator) and the hips of the exoskeleton---as this would be consistent with the clear increase in the $y$-torque. \ta{The ``force leak'' does not appear to allow all vertical forces to bypass the sensor. \ref{subs:amp}.1 clearly shows large forces.}
}


\reviewer{``Of our previous multi-joint controllers''---provide reference(s)}
\response{We replaced the comparison to unpublished previous versions of the controller with a comparison to \cite{ZanottoAkiyamaStegallAgrawal2015TRO}.}
\paperquote{
\ta{
	Our system is pioneering in that it amplifies human strength at the backpack/hip link of the exoskeleton; there are no direct performance comparisons for this control feature.
	Our steady state amplification of human forces by 300\% exceeded the 208\% amplification (52\% mass reduction) of sagittal hip moment in \cite{ZanottoAkiyamaStegallAgrawal2015TRO}, which also used force feedback to amplify human lower-body strength.
	However, this is not an exact comparison, as \cite{ZanottoAkiyamaStegallAgrawal2015TRO}'s system used a treadmill mounted exoskeleton, had a different sensing configuration, and has only two degrees of freedom whereas our system has 12.
	The amplification's pole frequency (.58 Hz) and amplification magnitude ($\alpha_0=3$) at the hip/backpack human--robot interface are comparable to our previous results on a 1-DOF human elbow exoskeleton; in the notation of Appendix A, \cite{HeThomasPaineSentis2019ACC}'s robust controller used $\alpha_0=10,\ k_G=0.1,\ Z_g=10,\ \text{and}\ P_g=0.01,$ resulting in an amplification magnitude of 2.995 at 0.58 Hz.
	However, unlike our controller, \cite{HeThomasPaineSentis2019ACC} had even greater amplification at lower frequencies: its lowest pole-pair was at $0.146$ Hz, and its steady state amplification rate was 9.91.
	%In terms of \emph{mechanical} performance, our preliminary testing suggests a payload capacity of $\sim$11-23 kg, which is lower than \cite{Kazerooni2005IROS}'s 34 kg.
}
}

\reviewer{the torque in the seconds 10-30 does not seem to be ``a rough continuation''. similar, albeit to a lesser degree, is true in the seconds 20-30. can the authors comment on this? is this a consequence of different joint angles (body position), or errors in calculations, or both?}
\response{A more detailed argument has been made:}
\paperquote{
As shown in Fig.~\ref{fig:experiment}'s fourth column, the human's effort was reduced to roughly a third of its value in the third column in the $y$-torque component.
\ta{More specifically, the disturbance due to the added weight, which can be seen by comparing \ref{subs:amp}.3 (with weight) against \ref{subs:amp}.2 (no weight) in terms of y-axis torque, is attenuated by the amplification factor, resulting in a much smaller disturbance effect when comparing \ref{subs:amp}.4 (attenuated weight) to \ref{subs:amp}.2 (no weight). We must make this comparison despite joint angle differences on the order of 10 degrees between these tests---a limitation of our operator and operator--robot coupling. In \ref{subs:amp}.4, the operator engages in two different squat positions (switching posture at roughly 10 and 20 seconds). The interface forces remain within 10-15 Nm despite these kinematic changes. This supports the notion that if the operator were able to perfectly reproduce the posture from Exp.~\ref{subs:amp}.3 in \ref{subs:amp}.4, the y-axis torque would also be within this range.}
}

% end page 14 begin page 15

\reviewer{[``what it was after the attaching'' highlight]}
\response{Clarified:}
\paperquote{
As shown in Fig.~\ref{fig:experiment}'s fourth column, the human's effort was reduced to roughly a third of its value in the third column in the $y$-torque component.
\ta{More specifically, the disturbance due to the added weight, which can be seen by comparing \ref{subs:amp}.3 (with weight) against \ref{subs:amp}.2 (no weight) in terms of y-axis torque, is attenuated by the amplification factor, resulting in a much smaller disturbance effect when comparing \ref{subs:amp}.4 (attenuated weight) to \ref{subs:amp}.2 (no weight). We must make this comparison despite joint angle differences on the order of 10 degrees between these tests---a limitation of our operator and operator--robot coupling. In \ref{subs:amp}.4, the operator engages in two different squat positions (switching posture at roughly 10 and 20 seconds). The interface forces remain within 10-15 Nm despite these kinematic changes. This supports the notion that if the operator were able to perfectly reproduce the posture from Exp.~\ref{subs:amp}.3 in \ref{subs:amp}.4, the y-axis torque would also be within this range.}
}

\reviewer{``but for both of these behaviors''---which behaviors? stair climbing and one-foot standing? please clarify}
\response{Clarified:}
\paperquote{
\ra{With or without amplification, the primary behavior of the system was to use shared-body control to partially compensate the robot's own gravity while allowing human-led foot transitions through the \ta{\emph{inter-foot force task}}.}\ta{Distributing weight between the two feet using the \ta{\emph{inter-foot force task}} is a key behavior of the system and was tested when the operator walked on level ground and stairs.}
Since the robot itself was based on high bandwidth torque-controlled actuation, the operator could easily backdrive it to climb up stairs or to stand on one foot.%
\ra{Since this was the case\ta{,} gravity compensation was the dominant effect of the controller, with amplification acting in a supplemental role.
	But \ta{with or without amplification}, the control of the contact transitions via the \ta{\emph{inter-foot force task}} was key.}
\ta{While this happened, the exoskeleton continued to compensate for its own gravitational weight and amplify strength at the hip/backpack sensor.}
}

\reviewer{what is meant by ``good human-led transitions''? what kind of transitions are ``good''?}
\response{Clarified:}
\paperquote{
\ta{Fig.~\ref{fig:demo}.b and Fig.~\ref{fig:transitions} show the operator shifting weight from one foot to another and lifting up the legs one at a time.}
\ta{This behavior highlights the human-led foot contact transitions and demonstrates how the weight is shifting in \emph{anticipation} of the actual contact transition.}
}

\reviewer{reference the relevant equation(s)
	
also re-phrase, as ``weightings Q1 and Q2 matrix'' does not sound well}

\response{Referenced, and re-phrased:}
\paperquote{
\ta{As mentioned in Sec.~\ref{sec:ift}, the weighting matrices $Q_1$ and $Q_2$ in \eqref{eq:Q1Q2def} are scheduled according to the robot's measurement of the human's weight distribution.}
}


		%%%%%%%%%%%%%%%%%%%%%%%%

		\reviewer{\label{rev7:rviz_figure}I find this figure very hard to read.
			
			for one, the background should probably be white so as to make the colours stand out.
			
			further, it is hard to read all the torques and forces even with when zoomed on a pc; this would be impossible to understand in the printed version.
			
			one option would be to remove all forces/torques/frames that do not add a lot to the point the authors are trying to make}
		
		\response{
This figure has been updated to improve the color intensity and overall contrast to the background, as shown earlier in Sec.~\ref{update:rviz_figure}.
With the improved contrast the forces and torques are more legible, and we hope this makes them readable on your pc.
		}
		

		I appreciate the detail of your comments, Reviewer \#7. Thank you for making an annotated pdf.



		\closing{That is all, I hope my changes have addressed all of your concerns. Please enjoy this newest edition of the paper.} 
		%\cc{Cclist} 
		%\ps{adding a postscript} 
		%\encl{list of enclosed material} 
	
	\bibliographystyle{IEEEtran}
	\input{ms.bbl}
	\end{letter} 
\end{document}